/*! For license information please see pnp.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pnp=t():e.pnp=t()}(self,(function(){return(()=>{"use strict";var e={584:(e,t,r)=>{r.r(t),r.d(t,{Batch:()=>Q,BearerTokenFetchClient:()=>M,BlobParser:()=>ye,BufferParser:()=>me,CachingConfigurationProvider:()=>z,CachingOptions:()=>X,CachingParserWrapper:()=>J,ConsoleListener:()=>l,DefaultRuntime:()=>B,FetchClient:()=>N,FunctionListener:()=>c,GraphNS:()=>s,HttpRequestError:()=>be,JSONParser:()=>fe,LambdaFetchClient:()=>q,LambdaParser:()=>ve,LogLevel:()=>i,Logger:()=>o,ODataParser:()=>pe,PipelineMethods:()=>xe,PnPClientStorage:()=>V,PnPClientStorageWrapper:()=>W,Queryable:()=>Pe,Runtime:()=>L,SPFxAdalClient:()=>j,SPListConfigurationProvider:()=>Ot,SPNS:()=>n,Settings:()=>G,TextParser:()=>ge,addProp:()=>Y,assign:()=>v,body:()=>Fe,clearGlobalExtensions:()=>ae,cloneQueryableData:()=>Se,combine:()=>h,config:()=>Nl,dateAdd:()=>d,default:()=>jl,defaultPipelineBinder:()=>De,disableExtensions:()=>le,enableExtensions:()=>ce,extendFactory:()=>se,extendGlobal:()=>ne,extendObj:()=>ie,getADALResource:()=>E,getCtxCallback:()=>u,getDefaultPipeline:()=>Re,getGUID:()=>g,getHashCode:()=>w,getRandomString:()=>p,graph:()=>Ol,hOP:()=>T,headers:()=>Le,invokableFactory:()=>de,isArray:()=>m,isFunc:()=>y,isUrlAbsolute:()=>b,jsS:()=>I,log:()=>Ml,mergeHeaders:()=>_,mergeMaps:()=>R,mergeOptions:()=>O,objectDefinedNotNull:()=>f,objectToMap:()=>x,onRuntimeCreate:()=>F,pipe:()=>we,pipelineBinder:()=>Ue,requestPipelineMethod:()=>Ce,safeGlobal:()=>A,sanitizeGuid:()=>P,setResult:()=>Ie,setup:()=>ql,sp:()=>_l,storage:()=>El,stringIsNullOrEmpty:()=>S,util:()=>Al});var n={};r.r(n),r.d(n,{AddFieldOptions:()=>In,App:()=>Dr,AppCatalog:()=>Rr,Attachment:()=>$r,Attachments:()=>Lr,CalendarType:()=>Tn,CanvasColumn:()=>Kr,CanvasSection:()=>Qr,CheckinType:()=>wr,Children:()=>Ns,ChoiceFieldFormatType:()=>xn,ClientsidePageFromFile:()=>Gr,ClientsideText:()=>Jr,ClientsideWebpart:()=>Yr,ColumnControl:()=>Xr,Comment:()=>Nr,Comments:()=>Or,ContentType:()=>an,ContentTypes:()=>sn,ControlMode:()=>xt,CreateClientsidePage:()=>zr,DateTimeFieldFormatType:()=>Sn,DateTimeFieldFriendlyFormatType:()=>Pn,Feature:()=>gn,Features:()=>hn,Field:()=>vn,FieldLink:()=>un,FieldLinks:()=>cn,FieldTypes:()=>bn,FieldUserSelectionMode:()=>Cn,Fields:()=>fn,File:()=>Sr,Files:()=>vr,Folder:()=>rn,Folders:()=>en,Form:()=>Dn,Forms:()=>Un,HubSite:()=>$n,HubSites:()=>Ln,Item:()=>Ft,ItemVersion:()=>$t,ItemVersions:()=>Bt,Items:()=>Ut,LimitedWebPartManager:()=>eo,List:()=>wt,Lists:()=>It,MoveOperations:()=>Cr,MySocial:()=>vs,Navigation:()=>Nn,NavigationNode:()=>On,NavigationNodes:()=>An,NavigationService:()=>qn,PageType:()=>Mt,PagedItemCollection:()=>kt,PermissionKind:()=>Oi,PrincipalSource:()=>Nt,PrincipalType:()=>Et,Profiles:()=>Wn,PromotedState:()=>jr,QueryPropertyValueType:()=>Ii,RegionalSettings:()=>Xn,RelatedItemManager:()=>ci,Relation:()=>Vs,Relations:()=>Hs,RenderListDataOptions:()=>Ct,ReorderingRuleMatchType:()=>Pi,Replies:()=>qr,RoleAssignment:()=>$i,RoleAssignments:()=>Bi,RoleDefinition:()=>_i,RoleDefinitions:()=>Ai,RoleType:()=>Wi,SPBatch:()=>ct,SPHttpClient:()=>Ae,SPRest:()=>ht,SPSharedObjectType:()=>Ni,Search:()=>fi,SearchBuiltInSourceId:()=>Ti,SearchQueryBuilder:()=>pi,SearchResults:()=>mi,SharePointQueryable:()=>Xe,SharePointQueryableCollection:()=>Ye,SharePointQueryableInstance:()=>et,SharingDomainRestrictionMode:()=>Mi,SharingLinkKind:()=>ji,SharingOperationStatusCode:()=>qi,SharingRole:()=>Ei,Site:()=>yt,SiteDesigns:()=>ls,SiteGroup:()=>Fi,SiteGroups:()=>Ui,SiteScripts:()=>ds,SiteUser:()=>xi,SiteUsers:()=>Ci,Social:()=>ys,SocialActorType:()=>Ss,SocialActorTypes:()=>Ps,SocialFollowResult:()=>Is,SocialStatusCode:()=>Ts,SortDirection:()=>Si,Subscription:()=>Ds,Subscriptions:()=>Rs,Suggest:()=>bi,TemplateFileType:()=>xr,Term:()=>js,TermGroup:()=>ks,TermGroups:()=>$s,TermSet:()=>Os,TermSets:()=>_s,TermStore:()=>Ls,Terms:()=>qs,TimeZone:()=>Yn,TimeZones:()=>ei,UrlFieldFormatType:()=>wn,UrlZone:()=>Qn,UserCustomAction:()=>si,UserCustomActionRegistrationType:()=>oi,UserCustomActionScope:()=>ai,UserCustomActions:()=>ni,Utilities:()=>ws,Version:()=>Tr,Versions:()=>Ir,View:()=>Ks,ViewFields:()=>Js,ViewScope:()=>Ys,Views:()=>zs,Web:()=>bt,WebPartDefinition:()=>no,WebPartDefinitions:()=>ro,WebPartsPersonalizationScope:()=>io,Webs:()=>mt,containsInvalidFileFolderChars:()=>Ht,defaultPath:()=>nt,extractWebUrl:()=>$e,objectToSPKeyValueCollection:()=>qt,registerCustomRequestClientFactory:()=>Ee,sp:()=>so,spDelete:()=>He,spGet:()=>je,spInvokableFactory:()=>Qe,spODataEntity:()=>at,spODataEntityArray:()=>lt,spPatch:()=>Ve,spPost:()=>We,spPostDelete:()=>Ge,spPostDeleteETag:()=>ze,stripInvalidFileFolderChars:()=>Vt,toAbsoluteUrl:()=>Oe});var i,s={};r.r(s),r.d(s,{Attachment:()=>Ro,Attachments:()=>Do,Bucket:()=>yl,Buckets:()=>ml,Calendar:()=>qo,Calendars:()=>Wo,Channel:()=>Ul,Channels:()=>Fl,Contact:()=>ta,ContactFolder:()=>sa,ContactFolders:()=>aa,Contacts:()=>na,Conversation:()=>yo,Conversations:()=>mo,DirectoryObject:()=>Lo,DirectoryObjectTypes:()=>ko,DirectoryObjects:()=>$o,Drive:()=>Aa,DriveItem:()=>qa,DriveItems:()=>Wa,Drives:()=>Oa,Event:()=>Vo,Events:()=>zo,GraphBatch:()=>Xt,GraphEndpoints:()=>Zt,GraphHttpClient:()=>Qt,GraphQueryable:()=>dr,GraphQueryableCollection:()=>pr,GraphQueryableInstance:()=>fr,GraphQueryableSearchableCollection:()=>gr,GraphRest:()=>Jt,Group:()=>Oo,GroupType:()=>Ao,Groups:()=>No,Insights:()=>ca,Invitations:()=>Ia,MailFolder:()=>Da,MailFolders:()=>La,MailboxSettings:()=>$a,Member:()=>Ta,Members:()=>Ca,Message:()=>xa,Messages:()=>Ua,Notebook:()=>Ga,Notebooks:()=>Qa,OneNote:()=>Va,People:()=>Zo,Photo:()=>Za,Plan:()=>sl,PlanDetails:()=>nl,Planner:()=>tl,Plans:()=>al,Post:()=>To,Posts:()=>Co,Resource:()=>Sa,Root:()=>Na,Search:()=>bl,Section:()=>Ka,Sections:()=>Ja,Senders:()=>xo,SharedInsight:()=>fa,SharedInsights:()=>va,Subscription:()=>Pl,Subscriptions:()=>Tl,Tab:()=>Bl,Tabs:()=>kl,Task:()=>dl,TaskDetails:()=>cl,Tasks:()=>pl,Team:()=>Cl,Teams:()=>Rl,Thread:()=>bo,Threads:()=>Po,TrendingInsight:()=>ua,TrendingInsights:()=>ha,UsedInsight:()=>pa,UsedInsights:()=>ya,User:()=>Ko,Users:()=>Jo,graph:()=>Yt,graphDelete:()=>or,graphGet:()=>ir,graphPatch:()=>ar,graphPost:()=>sr,graphPut:()=>lr,registerCustomRequestClientFactory:()=>er,toAbsoluteUrl:()=>Kt});class o{static get activeLogLevel(){return o.instance.activeLogLevel}static set activeLogLevel(e){o.instance.activeLogLevel=e}static get instance(){return void 0!==o._instance&&null!==o._instance||(o._instance=new a),o._instance}static subscribe(...e){e.forEach((e=>o.instance.subscribe(e)))}static clearSubscribers(){return o.instance.clearSubscribers()}static get count(){return o.instance.count}static write(e,t=1){o.instance.log({level:t,message:e})}static writeJSON(e,t=1){this.write(JSON.stringify(e),t)}static log(e){o.instance.log(e)}static error(e){o.instance.log({data:e,level:3,message:e.message})}}class a{constructor(e=2,t=[]){this.activeLogLevel=e,this.subscribers=t}subscribe(e){this.subscribers.push(e)}clearSubscribers(){const e=this.subscribers.slice(0);return this.subscribers.length=0,e}get count(){return this.subscribers.length}write(e,t=1){this.log({level:t,message:e})}log(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map((t=>t.log(e)))}}!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(i||(i={}));class l{log(e){const t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}}format(e){const t=[];if(t.push("Message: "+e.message),void 0!==e.data)try{t.push(" Data: "+JSON.stringify(e.data))}catch(e){t.push(` Data: Error in stringify of supplied data ${e}`)}return t.join("")}}class c{constructor(e){this.method=e}log(e){this.method(e)}}function u(e,t,...r){return function(){t.apply(e,r)}}function d(e,t,r){let n=new Date(e.toString());switch(t.toLowerCase()){case"year":n.setFullYear(n.getFullYear()+r);break;case"quarter":n.setMonth(n.getMonth()+3*r);break;case"month":n.setMonth(n.getMonth()+r);break;case"week":n.setDate(n.getDate()+7*r);break;case"day":n.setDate(n.getDate()+r);break;case"hour":n.setTime(n.getTime()+36e5*r);break;case"minute":n.setTime(n.getTime()+6e4*r);break;case"second":n.setTime(n.getTime()+1e3*r);break;default:n=void 0}return n}function h(...e){return e.filter((e=>!S(e))).map((e=>e.replace(/^[\\|/]/,"").replace(/[\\|/]$/,""))).join("/").replace(/\\/g,"/")}function p(e){const t=new Array(e);for(let r=0;r<e;r++)t[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t.join("")}function g(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)}))}function y(e){return"function"==typeof e}function f(e){return null!=e}function m(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function v(e,t,r=!1,n=(()=>!0)){if(!f(t))return e;const i=r?(e,t)=>!(t in e):()=>!0;return Object.getOwnPropertyNames(t).filter((t=>i(e,t)&&n(t))).reduce(((e,r)=>(e[r]=t[r],e)),e)}function b(e){return/^https?:\/\/|^\/\//i.test(e)}function S(e){return null==e||e.length<1}function P(e){if(S(e))return e;const t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]}function I(e){return JSON.stringify(e)}function T(e,t){return Object.hasOwnProperty.call(e,t)}function w(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}const C=y(Object.entries)?Object.entries:e=>Object.keys(e).map((t=>[t,e[t]]));function x(e){return f(e)?new Map(C(e)):new Map}function R(e,...t){for(let r=0;r<t.length;r++)t[r].forEach(((t,r)=>{"string"==typeof r&&"spfxContext"!==r&&"[object Object]"===Object.prototype.toString.call(t)?e.set(r,Object.assign({},e.get(r)||{},t)):e.set(r,t)}));return e}const U=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext","ie11"],D=[];function F(e){D.indexOf(e)<0&&(e(B),D.push(e))}class L{constructor(e=new Map){this._v=e;const t=(e,t)=>{this._v.has(e)||this._v.set(e,t)};t(U[0],"session"),t(U[1],60),t(U[2],!1),t(U[3],!1),t(U[4],750),t(U[5],null),t(U[6],!1),D.forEach((e=>e(this)))}assign(e){this._v=R(this._v,x(e))}get(e){return this._v.get(e)}export(){const e=new Map;for(const[t,r]of this._v)"__isDefault__"!==t&&e.set(t,r);return e}}const B=new L(new Map([["__isDefault__",!0]]));function $(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function k(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))}Object.create,Object.create;const A=void 0===r.g?window:r.g;function _(e,t){f(t)&&new Request("",{headers:t}).headers.forEach(((t,r)=>{e.append(r,t)}))}function O(e,t){if(f(t)){const r=v(e.headers||{},t.headers);(e=v(e,t)).headers=r}}function E(e){const t=new URL(e);return`${t.protocol}//${t.hostname}`}class N{fetch(e,t){return A.fetch(e,t)}}class M extends N{constructor(e){super(),this.token=e}fetch(e,t={}){const r=new Headers;return _(r,t.headers),r.set("Authorization",`Bearer ${this.token}`),t.headers=r,super.fetch(e,t)}}class q extends M{constructor(e){super(null),this.tokenFactory=e}fetch(e,t){const r=Object.create(null,{fetch:{get:()=>super.fetch}});return k(this,void 0,void 0,(function*(){return this.token=yield this.tokenFactory({url:e,options:t}),r.fetch.call(this,e,t)}))}}class j extends q{constructor(e){super((t=>k(this,void 0,void 0,(function*(){return(yield e.aadTokenProviderFactory.getTokenProvider()).getToken(E(t.url))})))),this.context=e}getToken(e){return k(this,void 0,void 0,(function*(){return(yield this.context.aadTokenProviderFactory.getTokenProvider()).getToken(e)}))}}class W{constructor(e,t=-1){this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),B.get("enableCacheExpiration")&&this.cacheExpirationHandler()}static bind(e){return new W(void 0===e?new H:e)}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!f(t))return null;const r=JSON.parse(t);return new Date(r.expiration)<=new Date?(this.delete(e),null):r.value}put(e,t,r){this.enabled&&this.store.setItem(e,this.createPersistable(t,r))}delete(e){this.enabled&&this.store.removeItem(e)}getOrPut(e,t,r){return k(this,void 0,void 0,(function*(){if(!this.enabled)return t();let n=this.get(e);return null===n&&(n=yield t(),this.put(e,n,r)),n}))}deleteExpired(){return k(this,void 0,void 0,(function*(){if(this.enabled)for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&(yield this.get(t))}}))}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){if(void 0===t){let e=B.get("defaultCachingTimeoutSeconds");this.defaultTimeoutMinutes>0&&(e=60*this.defaultTimeoutMinutes),t=d(new Date,"second",e)}return I({pnp:1,expiration:t,value:e})}cacheExpirationHandler(){this.enabled&&this.deleteExpired().then((()=>{setTimeout(u(this,this.cacheExpirationHandler),B.get("cacheExpirationIntervalMilliseconds"))})).catch(console.error)}}class H{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}class V{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=new W("undefined"==typeof localStorage?new H:localStorage)),this._local}get session(){return null===this._session&&(this._session=new W("undefined"==typeof sessionStorage?new H:sessionStorage)),this._session}}class G{constructor(e=new Map){this._settings=e}add(e,t){this._settings.set(e,t)}addJSON(e,t){this._settings.set(e,I(t))}apply(e){return new Promise(((t,r)=>{try{this._settings=R(this._settings,x(e)),t()}catch(e){r(e)}}))}load(e){return new Promise(((t,r)=>{e.getConfiguration().then((e=>{this._settings=R(this._settings,x(e)),t()})).catch(r)}))}get(e){return this._settings.get(e)||null}getJSON(e){const t=this.get(e);return null==t?t:JSON.parse(t)}}class z{constructor(e,t,r){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=r||this.selectPnPCache()}getWrappedProvider(){return this.wrappedProvider}getConfiguration(){return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,(()=>this.wrappedProvider.getConfiguration().then((e=>(this.store.put(this.cacheKey,e),e))))):this.wrappedProvider.getConfiguration()}selectPnPCache(){const e=new V;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw Error("Cannot create a caching configuration provider since cache is not available.")}}class Q{constructor(e=g()){this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[],this._index=-1}get batchId(){return this._batchId}get requests(){return this._reqs.sort(((e,t)=>e.index-t.index))}track(e){e.data.batch=this,(void 0===e.data.batchIndex||e.data.batchIndex<0)&&(e.data.batchIndex=++this._index)}add(e){const t={id:e.requestId,index:e.batchIndex,method:e.method.toUpperCase(),options:e.options,parser:e.parser,reject:null,resolve:null,url:e.url},r=new Promise(((e,r)=>{t.resolve=e,t.reject=r}));return this._reqs.push(t),r}addDependency(){let e=()=>{};return this._deps.push(new Promise((t=>{e=t}))),e}addResolveBatchDependency(e){this._rDeps.push(e)}execute(){return Promise.all(this._deps).then((()=>Promise.all(this._deps))).then((()=>this.executeImpl())).then((()=>Promise.all(this._rDeps))).then((()=>{}))}}const K=new V;class X{constructor(e,t,r){this.key=e,this.storeName=t,this.expiration=r}get store(){return"local"===this.storeName?K.local:K.session}}class J{constructor(e,t){this.parser=e,this.cacheOptions=t}parse(e){return this.parser.parse(e).then((e=>this.cacheData(e)))}cacheData(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e}}function Y(e,t,r,n){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return r(this,n)}})}let Z=!1;const ee=[],te=new Map,re=Symbol.for("43f7a601"),ne=e=>{Z=!0,oe(ee,e)},ie=(e,t)=>(Z=!0,Reflect.has(e,re)||Reflect.set(e,re,[]),oe(Reflect.get(e,re),t),e),se=(e,t)=>{Z=!0;const r=Reflect.getPrototypeOf(e);Reflect.has(r,re)||Reflect.defineProperty(r,re,{value:g()});const n=r[re];te.has(n)||te.set(n,[]),oe(te.get(n),t)};function oe(e,t){Array.isArray(t)?e.push(...t):e.push(t)}const ae=()=>{ee.length=0},le=()=>{Z=!1},ce=()=>{Z=!0};function ue(e,t,r,...n){if(Z){const t=[];Reflect.has(r,re)&&t.push(...Reflect.get(r,re)),t.push(...ee);for(let i=0;i<t.length;i++){const s=t[i];let o;if(y(s)?o=s(e,r,...n):"get"===e&&Reflect.has(s,n[0])?o=Reflect.get(s,n[0],r):Reflect.has(s,e)&&(o=Reflect.get(s,e)(r,...n)),void 0!==o)return o}}return t(r,...n)}const de=(he=function(e){return this.defaultAction(e)},e=>(...t)=>{const r=t=>{const r=Object.assign((function(...e){return he.call(r,...e)}),new e(...t));return Reflect.setPrototypeOf(r,e.prototype),r};return B.get("ie11")?r(t):new Proxy(((e,t)=>{let r=e(t);const n=Reflect.getPrototypeOf(e);if(Reflect.has(n,re)){const e=te.get(Reflect.get(n,re));r=ie(r,e)}return r})(r,t),{apply:(e,t,r)=>ue("apply",((...e)=>Reflect.apply(e[0],e[1],e[2])),e,t,r),get:(e,t,r)=>ue("get",((...e)=>Reflect.get(e[0],e[1],e[2])),e,t,r),has:(e,t)=>ue("has",((...e)=>Reflect.has(e[0],e[1])),e,t),set:(e,t,r,n)=>ue("set",((...e)=>Reflect.set(e[0],e[1],e[2],e[3])),e,t,r,n)})});var he;class pe{parse(e){return new Promise(((t,r)=>{this.handleError(e,r)&&this.parseImpl(e,t,r)}))}parseImpl(e,t,r){e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then((e=>e.replace(/\s/gi,"").length>0?JSON.parse(e):{})).then((e=>t(this.parseODataJSON(e)))).catch((e=>r(e)))}handleError(e,t){return e.ok||be.init(e).then(t),e.ok}parseODataJSON(e){let t=e;return T(e,"d")?t=T(e.d,"results")?e.d.results:e.d:T(e,"value")&&(t=e.value),t}}class ge extends pe{parseImpl(e,t){e.text().then(t)}}class ye extends pe{parseImpl(e,t){e.blob().then(t)}}class fe extends pe{parseImpl(e,t){e.json().then(t)}}class me extends pe{parseImpl(e,t){y(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)}}class ve extends pe{constructor(e){super(),this.parser=e}parseImpl(e,t){this.parser(e).then(t)}}class be extends Error{constructor(e,t,r=t.status,n=t.statusText){super(e),this.response=t,this.status=r,this.statusText=n,this.isHttpRequestError=!0}static init(e){return k(this,void 0,void 0,(function*(){const t=yield e.clone().text();return new be(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e.clone())}))}}function Se(e){let t;e.options&&e.options.body&&(t=e.options.body,e.options.body="-");const r=JSON.stringify(e,((e,t)=>{switch(e){case"query":return JSON.stringify([...t]);case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return"-";default:return t}}),0),n=JSON.parse(r,((t,r)=>{switch(t){case"query":return new Map(JSON.parse(r));case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return e[t];default:return r}}));return t&&(n.options.body=t,e.options.body=t),n}class Pe{constructor(e={}){this._data=Object.assign({},{cloneParentWasCaching:!1,options:{},parentUrl:"",parser:new pe,query:new Map,url:"",useCaching:!1},Se(e)),this._runtime=null}get data(){return this._data}set data(e){this._data=Object.assign({},this.data,Se(e))}getRuntime(){return null===this._runtime?B:this._runtime}setRuntime(...e){return e[0]instanceof L?this._runtime=e[0]:(this._runtime=e[0]?new L(B.export()):new L,e.length>1&&f(e[1])&&this._runtime.assign(e[1])),this}toUrl(){return this.data.url}concat(e){return this.data.url+=e,this}get query(){return this.data.query}configure(e){return O(this.data.options,e),this}configureFrom(e){O(this.data.options,e.data.options);const t=e.getRuntime();return t.get("__isDefault__")||this.setRuntime(t),this}usingCaching(e){const t=this.getRuntime();if(!t.get("globalCacheDisable")){if(this.data.useCaching=!0,"string"==typeof e){if(S(e))throw Error("Cache key cannot be empty.");e={key:e}}const r={expiration:d(new Date,"second",t.get("defaultCachingTimeoutSeconds")),storeName:t.get("defaultCachingStore")};this.data.cachingOptions=v(r,e)}return this}usingParser(e){return this.data.parser=e,this}withPipeline(e){return this.data.pipes=e.slice(0),this}append(e){this.data.url=h(this.data.url,e)}inBatch(e){if(this.hasBatch)throw Error("This query is already part of a batch.");return f(e)&&e.track(this),this}addBatchDependency(){return f(this.data.batch)?this.data.batch.addDependency():()=>null}get hasBatch(){return f(this.data.batch)}get batch(){return this.hasBatch?this.data.batch:null}get parentUrl(){return this.data.parentUrl}cloneTo(e,t={}){return t=v({includeBatch:!0,includeQuery:!1},t),e.data=Object.assign({},Se(this.data),{batch:null,cloneParentCacheOptions:null,cloneParentWasCaching:!1},Se(e.data)),e.configureFrom(this),t.includeBatch&&e.inBatch(this.batch),t.includeQuery&&this.query.size>0&&this.query.forEach(((t,r)=>e.query.set(r,t))),this.data.useCaching&&(e.data.cloneParentWasCaching=!0,e.data.cloneParentCacheOptions=this.data.cachingOptions),e}}function Ie(e,t){return new Promise((r=>{e.result=t,e.hasResult=!0,r(e)}))}function Te(e){return e.pipes.length>0?e.pipes.shift()(e):Promise.resolve(e)}function we(e){if(e.pipes.length<1)throw o.write(`[${e.requestId}] (${(new Date).getTime()}) Request pipeline contains no methods!`,3),Error("Request pipeline contains no methods!");const t=Te(e).then((e=>function(e){return o.log({data:0===o.activeLogLevel?e.result:{},level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Returning result from pipeline. Set logging to verbose to see data.`}),Promise.resolve(e.result)}(e))).catch((e=>{throw o.error(e),e}));return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function Ce(e=!1){return(t,r,n)=>{const i=n.value;n.value=function(...n){return!e&&n.length>0&&T(n[0],"hasResult")&&n[0].hasResult?(o.write(`[${n[0].requestId}] (${(new Date).getTime()}) Skipping request pipeline method ${r}, existing result in pipeline.`,0),Promise.resolve(n[0])):(o.write(`[${n[0].requestId}] (${(new Date).getTime()}) Calling request pipeline method ${r}.`,0),i.apply(t,n).then((e=>Te(e))))}}}class xe{static logStart(e){return new Promise((t=>{o.log({data:1===o.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Beginning ${e.method} request (${e.url})`}),t(e)}))}static caching(e){return new Promise((t=>{if(e.useCaching){o.write(`[${e.requestId}] (${(new Date).getTime()}) Caching is enabled for request, checking cache...`,1);let r=new X(e.url.toLowerCase());if(void 0!==e.cachingOptions&&(r=v(r,e.cachingOptions)),null!==r.store){let n=r.store.get(r.key);if(null!==n)return o.log({data:1===o.activeLogLevel?{}:n,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Value returned from cache.`}),y(e.batchDependency)&&e.batchDependency(),T(e.parser,"hydrate")&&(n=e.parser.hydrate(n)),Ie(e,n).then((e=>t(e)))}o.write(`[${e.requestId}] (${(new Date).getTime()}) Value not found in cache.`,1),e.parser=new J(e.parser,r)}return t(e)}))}static send(e){return new Promise(((t,r)=>{if(e.isBatched){const r=e.batch.add(e);y(e.batchDependency)&&e.batchDependency(),o.write(`[${e.requestId}] (${(new Date).getTime()}) Batching request in batch ${e.batch.batchId}.`,1),t(Ie(e,r))}else{o.write(`[${e.requestId}] (${(new Date).getTime()}) Sending request.`,1);const n=e.clientFactory(),i=v(e.options||{},{method:e.method});n.fetch(e.url,i).then((t=>e.parser.parse(t))).then((t=>Ie(e,t))).then((e=>t(e))).catch((e=>r(e)))}}))}static logEnd(e){return new Promise((t=>{e.isBatched?o.log({data:1===o.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) ${e.method} request will complete in batch ${e.batch.batchId}.`}):o.log({data:1===o.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Completing ${e.method} request.`}),t(e)}))}}function Re(){return[xe.logStart,xe.caching,xe.send,xe.logEnd].slice(0)}function Ue(e){return function(t){return function(r){return function(n){return we(Object.assign({},{batch:null,batchDependency:null,batchIndex:-1,cachingOptions:null,clientFactory:t,cloneParentCacheOptions:null,cloneParentWasCaching:!1,hasResult:!1,isBatched:f(n.batch),method:r,options:null,parentUrl:"",parser:new pe,pipes:e.slice(0),query:new Map,requestId:g(),url:"",useCaching:/^get$/i.test(n.method)&&n.useCaching},Se(n)))}}}}$([Ce(!0)],xe,"logStart",null),$([Ce()],xe,"caching",null),$([Ce()],xe,"send",null),$([Ce(!0)],xe,"logEnd",null);const De=Ue(Re());function Fe(e,t){return Object.assign({body:I(e)},t)}function Le(e,t){return Object.assign({headers:e},t)}function Be(e){return{__metadata:{type:e}}}function $e(e){if(S(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}function ke(e){return function(t,r,n){void 0===n&&(n=Object.getOwnPropertyDescriptor(t,r));const i=n.value;return n.value=function(...t){return k(this,void 0,void 0,(function*(){return this.configure(Le({"X-PnPjs-Tracking":e})),i.apply(this,t)}))},n}}ke.getClientTag=(e,t=!0)=>{if(e.has("X-PnPjs-Tracking")){const r=e.get("X-PnPjs-Tracking");if(t&&e.delete("X-PnPjs-Tracking"),!S(r))return r}return""},ke.configure=(e,t)=>e.configure(Le({"X-PnPjs-Tracking":t})),ke.isTagged=e=>e.data.options.headers&&e.data.options.headers["X-PnPjs-Tracking"];class Ae{constructor(...e){var t;if(e[0]instanceof L?this._runtime=e[0]:(this._runtime=e.length>1&&e[1]instanceof L?e[1]:B,this._impl=e[0]),this._impl=(null===(t=this._runtime.get("sp"))||void 0===t?void 0:t.fetchClientFactory())||null,null===this._impl)throw Error("Could not generate fetchClientFactory in SPHttpClient.");this._digestCache=function(e){return t=>k(this,void 0,void 0,(function*(){var r,n;const i=_e.get(t);if(void 0!==i&&new Date<i.expiration)return i.value;const s=h(t,"/_api/contextinfo"),o=yield e.fetchRaw(s,{cache:"no-cache",credentials:"same-origin",headers:v({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},null===(n=null===(r=e._runtime.get("sp"))||void 0===r?void 0:r.sp)||void 0===n?void 0:n.headers,!0),method:"POST"}),a=yield(new pe).parse(o).then((e=>e.GetContextWebInformation)),l={expiration:d(new Date,"second",a.FormDigestTimeoutSeconds),value:a.FormDigestValue};return _e.set(t,l),l.value}))}(this)}fetch(e,t={}){var r,n;return k(this,void 0,void 0,(function*(){let i=v(t,{cache:"no-cache",credentials:"same-origin"},!0);const s=new Headers;if(_(s,null===(n=null===(r=this._runtime.get("sp"))||void 0===r?void 0:r.sp)||void 0===n?void 0:n.headers),_(s,t.headers),s.has("Accept")||s.append("Accept","application/json"),s.has("Content-Type")||s.append("Content-Type","application/json;odata=verbose;charset=utf-8"),!s.has("X-ClientService-ClientTag")){let e=`PnPCoreJS:2.1.0:${ke.getClientTag(s)}`;e.length>32&&(e=e.substr(0,32)),s.append("X-ClientService-ClientTag",e)}if(i=v(i,{headers:s}),i.method&&"GET"!==i.method.toUpperCase()&&!s.has("X-RequestDigest")&&!s.has("Authorization")){const t=yield this._digestCache($e(e));s.append("X-RequestDigest",t)}return this.fetchRaw(e,i)}))}fetchRaw(e,t={}){const r=new Headers;_(r,t.headers),t=v(t,{headers:r});const n=r=>{const i=e=>{let t;e.headers.has("Retry-After")?t=1e3*parseInt(e.headers.get("Retry-After"),10):(t=r.delay,r.delay*=2),r.attempts++,r.retryCount<=r.attempts?r.reject(Error(`Retry count exceeded (${r.retryCount}) for request. Response status: [${e.status}] ${e.statusText}`)):setTimeout(u(this,n,r),t)};this._impl.fetch(e,t).then((e=>{429===e.status?i(e):r.resolve(e)})).catch((e=>{503===e.status||504===e.status?i(e):r.reject(e)}))};return new Promise(((e,t)=>{n.call(this,{attempts:0,delay:100,reject:t,resolve:e,retryCount:7})}))}get(e,t={}){const r=v(t,{method:"GET"});return this.fetch(e,r)}post(e,t={}){const r=v(t,{method:"POST"});return this.fetch(e,r)}patch(e,t={}){const r=v(t,{method:"PATCH"});return this.fetch(e,r)}delete(e,t={}){const r=v(t,{method:"DELETE"});return this.fetch(e,r)}}const _e=new Map;function Oe(e,t=B){var r,n;return k(this,void 0,void 0,(function*(){if(b(e))return e;const i=null===(r=t.get("sp"))||void 0===r?void 0:r.baseUrl,s=null===(n=t.get("sp"))||void 0===n?void 0:n.fetchClientFactory;if(!S(i))return h(i,e);const o=t.get("spfxContext");if(o)return h(o.pageContext.web.absoluteUrl,e);if(s){const t=s();if(T(t,"siteUrl"))return h(t.siteUrl,e)}if(void 0!==A._spPageContextInfo){if(T(A._spPageContextInfo,"webAbsoluteUrl"))return h(A._spPageContextInfo.webAbsoluteUrl,e);if(T(A._spPageContextInfo,"webServerRelativeUrl"))return h(A._spPageContextInfo.webServerRelativeUrl,e)}if(void 0!==A.location){const t=A.location.toString().toLowerCase();["/_layouts/","/siteassets/","/sitepages/"].forEach((r=>{const n=t.indexOf(r);if(n>0)return h(t.substr(0,n),e)}))}return e}))}function Ee(e){Me=y(e)?()=>e:Ne}const Ne=e=>()=>new Ae(e);let Me=Ne;const qe=e=>function(t,r){return k(this,void 0,void 0,(function*(){const n=t.getRuntime(),i=De(Me(n))(e),s=Se(t.data),o=f(s.batch)?s.batch.addDependency():()=>{},a=yield Oe(t.toUrlAndQuery(),n);return O(s.options,r),i(Object.assign({},s,{batchDependency:o,url:a}))}))},je=(e,t)=>(e.data.cloneParentWasCaching&&e.usingCaching(e.data.cloneParentCacheOptions),e._forceCaching&&(e.data.useCaching=!0),qe("GET")(e,t)),We=(e,t)=>qe("POST")(e,t),He=(e,t)=>qe("DELETE")(e,t),Ve=(e,t)=>qe("PATCH")(e,t),Ge=(e,t)=>{const r=Object.assign(Le({"X-HTTP-Method":"DELETE"}),t);return We(e,r)},ze=(e,t,r="*")=>{const n=Object.assign(Le({"X-HTTP-Method":"DELETE","IF-Match":r}),t);return We(e,n)},Qe=e=>de(e);class Ke extends Pe{constructor(e,t){let r="",n="";const i=new Map;if("string"==typeof e)if(b(e)||e.lastIndexOf("/")<0)n=e,r=h(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const i=e.lastIndexOf("/");n=e.slice(0,i),t=h(e.slice(i),t),r=h(n,t)}else{const i=e.lastIndexOf("(");n=e.slice(0,i),r=h(e,t)}else{n=e.toUrl(),r=h(n,t||"");const s=e.query.get("@target");void 0!==s&&i.set("@target",s)}super({parentUrl:n,query:i,url:r}),"string"!=typeof e&&this.configureFrom(e),this._forceCaching=!1}toUrlAndQuery(){const e=new Map(this.query);let t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,((t,r,n)=>(o.write(`Rewriting aliased parameter from match ${t} to label: ${r} value: ${n}`,0),e.set(r,`'${n}'`),r)));if(e.size>0){const r=t.indexOf("?")>-1?"&":"?";t+=`${r}${Array.from(e).map((e=>e[0]+"="+e[1])).join("&")}`}return t}select(...e){return e.length>0&&this.query.set("$select",e.map(encodeURIComponent).join(",")),this}get(e){return je(this,e)}expand(...e){return e.length>0&&this.query.set("$expand",e.map(encodeURIComponent).join(",")),this}clone(e,t,r=!0,n=!1){const i=super.cloneTo(e(this,t),{includeBatch:r,includeQuery:n});if(!n){const e="@target";this.query.has(e)&&i.query.set(e,this.query.get(e))}return i}defaultAction(e){return je(this,e)}getParent(e,t=this.parentUrl,r,n){let i=e(t,r).configureFrom(this);const s="@target";return this.query.has(s)&&i.query.set(s,this.query.get(s)),void 0!==n&&(i=i.inBatch(n)),i}}const Xe=Qe(Ke);class Je extends Ke{filter(e){return this.query.set("$filter",encodeURIComponent(e)),this}orderBy(e,t=!0){const r="$orderby",n=this.query.has(r)?this.query.get(r).split(","):[];return n.push(`${encodeURIComponent(e)} ${t?"asc":"desc"}`),this.query.set(r,n.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}const Ye=Qe(Je);class Ze extends Ke{_update(e,t){return r=>We(ke.configure(this,`${e}.Update`),{body:I(v(Be(e),r)),headers:{"X-HTTP-Method":"MERGE"}}).then((e=>t(e,r)))}}const et=Qe(Ze);function tt(e){return function(){return Ge(ke.configure(this,`${e}.delete`))}}function rt(e){return function(t="*"){return ze(ke.configure(this,`${e}.delete`),{},t)}}function nt(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}function it(e){const t=[],r=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(T(e,r[0])&&"SP.Web"===e[r[0]])T(e,r[4])?t.push(e[r[4]]):T(e,r[2])&&t.push(e.__metadata.uri);else if(T(e,r[3])&&T(e,r[1])){const n=b(e[r[1]])?e[r[1]].split("_api")[1]:e[r[1]];t.push($e(e[r[3]]),"_api",n)}else T(e,r[1])?t.push("_api",e[r[1]]):T(e,r[2])&&t.push(e.__metadata.uri);return t.length<1?(o.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):h(...t)}class st extends pe{constructor(e){super(),this.factory=e,this.hydrate=e=>v(this.factory(it(e),null),e)}parse(e){return super.parse(e).then((e=>v(this.factory(it(e),null),e)))}}class ot extends pe{constructor(e){super(),this.factory=e,this.hydrate=e=>e.map((e=>v(this.factory(it(e),null),e)))}parse(e){return super.parse(e).then((e=>e.map((e=>v(this.factory(it(e),null),e)))))}}function at(e){return new st(e)}function lt(e){return new ot(e)}class ct extends Q{constructor(e,t=B){super(),this.url=e,this.runtime=t}static ParseResponse(e){const t=[],r="--batchresponse_",n=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),i=e.split("\n");let s,o,a="batch";for(let e=0;e<i.length;++e){const l=i[e];switch(a){case"batch":if(l.substr(0,r.length)===r)a="batchHeaders";else if(""!==l.trim())throw Error(`Invalid response, line ${e}`);break;case"batchHeaders":""===l.trim()&&(a="status");break;case"status":{const t=n.exec(l);if(3!==t.length)throw Error(`Invalid status, line ${e}`);s=parseInt(t[1],10),o=t[2],a="statusHeaders";break}case"statusHeaders":""===l.trim()&&(a="body");break;case"body":t.push(204===s?new Response:new Response(l,{status:s,statusText:o})),a="batch"}}if("status"!==a)throw Error("Unexpected end of input");return t}executeImpl(){var e;return k(this,void 0,void 0,(function*(){if(o.write(`[${this.batchId}] (${(new Date).getTime()}) Executing batch with ${this.requests.length} requests.`,1),this.requests.length<1)return void o.write("Resolving empty batch.",1);const t=new Ae(this.runtime),r=yield Oe(this.url,this.runtime),n=[];let i="";for(let t=0;t<this.requests.length;t++){const s=this.requests[t];"GET"===s.method?(i.length>0&&(n.push(`--changeset_${i}--\n\n`),i=""),n.push(`--batch_${this.batchId}\n`)):(i.length<1&&(i=g(),n.push(`--batch_${this.batchId}\n`),n.push(`Content-Type: multipart/mixed; boundary="changeset_${i}"\n\n`)),n.push(`--changeset_${i}\n`)),n.push("Content-Type: application/http\n"),n.push("Content-Transfer-Encoding: binary\n\n");const a=new Headers,l=b(s.url)?s.url:h(r,s.url);if(o.write(`[${this.batchId}] (${(new Date).getTime()}) Adding request ${s.method} ${l} to batch.`,0),"GET"!==s.method){let e=s.method;const t=s.options.headers;T(s,"options")&&T(s.options,"headers")&&void 0!==t["X-HTTP-Method"]&&(e=t["X-HTTP-Method"],delete t["X-HTTP-Method"]),n.push(`${e} ${l} HTTP/1.1\n`),a.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else n.push(`${s.method} ${l} HTTP/1.1\n`);_(a,null===(e=this.runtime.get("sp"))||void 0===e?void 0:e.headers),s.options&&_(a,s.options.headers),a.has("Accept")||a.append("Accept","application/json"),a.has("Content-Type")||a.append("Content-Type","application/json;odata=verbose;charset=utf-8"),a.has("X-ClientService-ClientTag")||a.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-2.1.0:batch"),a.forEach(((e,t)=>{n.push(`${t}: ${e}\n`)})),n.push("\n"),s.options.body&&n.push(`${s.options.body}\n\n`)}i.length>0&&(n.push(`--changeset_${i}--\n\n`),i=""),n.push(`--batch_${this.batchId}--\n`);const s={body:n.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${this.batchId}`},method:"POST"};o.write(`[${this.batchId}] (${(new Date).getTime()}) Sending batch request.`,1);const a=yield t.fetch(h(r,"/_api/$batch"),s);if(!a.ok)throw yield be.init(a);const l=yield a.clone().text(),c=ct.ParseResponse(l);if(c.length!==this.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return o.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched requests.`,1),c.reduce(((e,t,r)=>e.then((()=>k(this,void 0,void 0,(function*(){const e=this.requests[r];o.write(`[${e.id}] (${(new Date).getTime()}) Resolving request in batch ${this.batchId}.`,1);try{e.resolve(yield e.parser.parse(t))}catch(t){e.reject(t)}}))))),Promise.resolve(void 0))}))}}const ut="00000000-0000-0000-0000-000000000000";function dt(e,t=B){t.assign(e)}F((e=>{const t=e.get("sp"),r=Object.assign({},{fetchClientFactory:()=>new N},t);e.assign({sp:r})}));class ht{constructor(e={},t="",r=B){this._options=e,this._baseUrl=t,this._runtime=r}configure(e,t=""){return new ht(e,t)}setup(e){e.pageContext?dt({spfxContext:e},this._runtime):dt(e,this._runtime)}createIsolated(e){return k(this,void 0,void 0,(function*(){e=Object.assign({baseUrl:"",cloneGlobal:!0,config:{},options:{}},e||{});const{baseUrl:t,cloneGlobal:r,options:n,config:i}=e,s=r?new L(B.export()):new L;return s.assign(i),new ht(n,t,s)}))}childConfigHook(e){return e({options:this._options,baseUrl:this._baseUrl,runtime:this._runtime})}}function pt(e){return S(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,((e,t,r)=>(o.write(`Rewriting aliased parameter from match ${e} to label: ${t} value: ${r}`,0),`!${t}::${encodeURIComponent(r.replace(/'/gi,"''"))}`))):encodeURIComponent(e.replace(/'/gi,"''"))}new ht;let gt=class extends Ze{get rootWeb(){return ke.configure(bt(this,"rootweb"),"si.rootWeb")}getChanges(e){const t=Fe({query:v(Be("SP.ChangeQuery"),e)});return We(this.clone(bt,"getchanges"),t)}openWebById(e){return k(this,void 0,void 0,(function*(){const t=yield We(this.clone(yt,`openWebById('${e}')`));return{data:t,web:bt($e(it(t)))}}))}getRootWeb(){return k(this,void 0,void 0,(function*(){const e=yield this.rootWeb.select("Url")();return ke.configure(bt(e.Url),"si.getRootWeb")}))}getContextInfo(){return k(this,void 0,void 0,(function*(){const e=ke.configure(yt(this.parentUrl,"_api/contextinfo"),"si.getContextInfo"),t=yield We(e);if(T(t,"GetContextWebInformation")){const e=t.GetContextWebInformation;return e.SupportedSchemaVersions=e.SupportedSchemaVersions.results,e}return t}))}createBatch(){return new ct(this.parentUrl,this.getRuntime())}delete(){return k(this,void 0,void 0,(function*(){const e=yield this.clone(yt,"").select("Id")(),t=ke.configure(yt(this.parentUrl,"_api/SPSiteManager/Delete"),"si.delete");yield We(t,Fe({siteId:e.Id}))}))}getDocumentLibraries(e){return k(this,void 0,void 0,(function*(){const t=ke.configure(Xe("","_api/sp.web.getdocumentlibraries(@v)"),"si.getDocumentLibraries");t.query.set("@v",`'${pt(e)}'`);const r=yield t();return T(r,"GetDocumentLibraries")?r.GetDocumentLibraries:r}))}getWebUrlFromPageUrl(e){return k(this,void 0,void 0,(function*(){const t=ke.configure(Xe("","_api/sp.web.getweburlfrompageurl(@v)"),"si.getWebUrlFromPageUrl");t.query.set("@v",`'${pt(e)}'`);const r=yield t();return T(r,"GetWebUrlFromPageUrl")?r.GetWebUrlFromPageUrl:r}))}createCommunicationSite(e,t=1033,r=!1,n,i,s,o,a,l){return k(this,void 0,void 0,(function*(){return this.createCommunicationSiteFromProps({Classification:s,Description:i,HubSiteId:a,Lcid:t,Owner:l,ShareByEmailEnabled:r,SiteDesignId:o,Title:e,Url:n})}))}createCommunicationSiteFromProps(e){return k(this,void 0,void 0,(function*(){const t=Object.assign({},{Classification:"",Description:"",HubSiteId:ut,Lcid:1033,ShareByEmailEnabled:!1,SiteDesignId:ut,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:ut},e),r=Fe({request:v(Be("Microsoft.SharePoint.Portal.SPSiteCreationRequest"),t)});return We(yt($e(this.toUrl()),"/_api/SPSiteManager/Create"),r)}))}exists(e){return k(this,void 0,void 0,(function*(){const t=Fe({url:e});return yield We(yt($e(this.toUrl()),"/_api/SP.Site.Exists"),t)}))}createModernTeamSite(e,t,r,n,i,s,o,a,l){return k(this,void 0,void 0,(function*(){return this.createModernTeamSiteFromProps({alias:t,classification:s,description:i,displayName:e,hubSiteId:a,isPublic:r,lcid:n,owners:o,siteDesignId:l})}))}createModernTeamSiteFromProps(e){return k(this,void 0,void 0,(function*(){const t=Object.assign({},{classification:"",description:"",hubSiteId:ut,isPublic:!0,lcid:1033,owners:[]},e),r={alias:t.alias,displayName:t.displayName,isPublic:t.isPublic,optionalParams:{Classification:t.classification,CreationOptions:{results:[`SPSiteLanguage:${t.lcid}`,`HubSiteId:${t.hubSiteId}`]},Description:t.description,Owners:{results:t.owners}}};return t.siteDesignId&&r.optionalParams.CreationOptions.results.push(`implicit_formula_292aa8a00786498a87a5ca52d9f4214a_${t.siteDesignId}`),We(yt($e(this.toUrl()),"/_api/GroupSiteManager/CreateGroupEx"),Fe(r))}))}};$([ke("si.getChanges")],gt.prototype,"getChanges",null),$([ke("si.openWebById")],gt.prototype,"openWebById",null),gt=$([nt("_api/site")],gt);const yt=Qe(gt);Reflect.defineProperty(ht.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>yt(t).configure(e).setRuntime(r)))}});let ft=class extends Je{add(e,t,r="",n="STS",i=1033,s=!0){return k(this,void 0,void 0,(function*(){const o=Fe({parameters:v(Be("SP.WebCreationInformation"),{Description:r,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:s,WebTemplate:n})}),a=yield We(this.clone(mt,"add"),o);return{data:a,web:bt(it(a).replace(/_api\/web\/?/i,""))}}))}};$([ke("ws.add")],ft.prototype,"add",null),ft=$([nt("webs")],ft);const mt=Qe(ft);let vt=class extends Ze{constructor(){super(...arguments),this.delete=tt("w")}get webs(){return mt(this)}get allProperties(){return ke.configure(this.clone(et,"allproperties"),"w.allprops")}get webinfos(){return ke.configure(Ye(this,"webinfos"),"w.webinfos")}getParentWeb(){return k(this,void 0,void 0,(function*(){const{ParentWeb:e}=yield je(this.select("ParentWeb/Id").expand("ParentWeb"));return(null==e?void 0:e.Id)?yt(this.parentUrl).openWebById(e.Id):null}))}update(e){return k(this,void 0,void 0,(function*(){const t=Fe(v(Be("SP.Web"),e),Le({"X-HTTP-Method":"MERGE"}));return{data:yield We(this,t),web:this}}))}applyTheme(e,t,r,n){const i=Fe({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:n});return We(this.clone(bt,"applytheme"),i)}applyWebTemplate(e){const t=this.clone(bt,"applywebtemplate");return t.concat(`(webTemplate='${pt(e)}')`),We(t)}getChanges(e){const t=Fe({query:v(Be("SP.ChangeQuery"),e)});return We(this.clone(bt,"getchanges"),t)}mapToIcon(e,t=0,r=""){return je(this.clone(bt,`maptoicon(filename='${pt(e)}', progid='${pt(r)}', size=${t})`))}getStorageEntity(e){return je(this.clone(bt,`getStorageEntity('${pt(e)}')`))}setStorageEntity(e,t,r="",n=""){return We(this.clone(bt,"setStorageEntity"),Fe({comments:n,description:r,key:e,value:t}))}removeStorageEntity(e){return We(this.clone(bt,`removeStorageEntity('${pt(e)}')`))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){const r=this.clone(Ye,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`);return ke.configure(r,"w.getSubwebsFilteredForCurrentUser")}createBatch(){return new ct(this.parentUrl,this.getRuntime())}availableWebTemplates(e=1033,t=!0){const r=`getavailablewebtemplates(lcid=${e}, doincludecrosslanguage=${t})`;return ke.configure(Ye(this,r),"w.availableWebTemplates")}};$([ke("w.getParentWeb")],vt.prototype,"getParentWeb",null),$([ke("w.update")],vt.prototype,"update",null),$([ke("w.applyTheme")],vt.prototype,"applyTheme",null),$([ke("w.applyWebTemplate")],vt.prototype,"applyWebTemplate",null),$([ke("w.getChanges")],vt.prototype,"getChanges",null),$([ke("w.mapToIcon")],vt.prototype,"mapToIcon",null),$([ke("w.getStorageEntity")],vt.prototype,"getStorageEntity",null),$([ke("w.setStorageEntity")],vt.prototype,"setStorageEntity",null),$([ke("w.removeStorageEntity")],vt.prototype,"removeStorageEntity",null),vt=$([nt("_api/web")],vt);const bt=Qe(vt);function St(e){return{DecodedUrl:e,__metadata:{type:"SP.ResourcePath"}}}let Pt=class extends Je{getById(e){return ke.configure(wt(this).concat(`('${e}')`),"ls.getById")}getByTitle(e){return ke.configure(wt(this,`getByTitle('${pt(e)}')`),"ls.getByTitle")}add(e,t="",r=100,n=!1,i={}){return k(this,void 0,void 0,(function*(){const s=Object.assign({AllowContentTypes:n,BaseTemplate:r,ContentTypesEnabled:n,Description:t,Title:e},Be("SP.List"),i);return{data:yield We(this,Fe(s)),list:this.getByTitle(s.Title)}}))}ensure(e,t="",r=100,n=!1,i={}){return k(this,void 0,void 0,(function*(){if(this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");const s=v(i,{Title:e,Description:t,ContentTypesEnabled:n},!0),o=this.getByTitle(s.Title);try{return yield o.select("Title")(),{created:!1,data:yield o.update(s).then((e=>e.data)),list:this.getByTitle(s.Title)}}catch(i){return{created:!0,data:yield this.add(e,t,r,n,s).then((e=>e.data)),list:this.getByTitle(s.Title)}}}))}ensureSiteAssetsLibrary(){return k(this,void 0,void 0,(function*(){const e=yield We(this.clone(It,"ensuresiteassetslibrary"));return wt(it(e))}))}ensureSitePagesLibrary(){return k(this,void 0,void 0,(function*(){const e=yield We(this.clone(It,"ensuresitepageslibrary"));return wt(it(e))}))}};$([ke("ls.add")],Pt.prototype,"add",null),$([ke("ls.ensure")],Pt.prototype,"ensure",null),$([ke("ls.ensureSiteAssetsLibrary")],Pt.prototype,"ensureSiteAssetsLibrary",null),$([ke("ls.ensureSitePagesLibrary")],Pt.prototype,"ensureSitePagesLibrary",null),Pt=$([nt("lists")],Pt);const It=Qe(Pt);class Tt extends Ze{constructor(){super(...arguments),this.delete=rt("l")}get effectiveBasePermissions(){return ke.configure(Xe(this,"EffectiveBasePermissions"),"l.effectiveBasePermissions")}get eventReceivers(){return ke.configure(Ye(this,"EventReceivers"),"l.eventReceivers")}get relatedFields(){return ke.configure(Xe(this,"getRelatedFields"),"l.relatedFields")}get informationRightsManagementSettings(){return ke.configure(Xe(this,"InformationRightsManagementSettings"),"l.informationRightsManagementSettings")}update(e,t="*"){return k(this,void 0,void 0,(function*(){const r=Fe(v(Be("SP.List"),e),Le({"IF-Match":t,"X-HTTP-Method":"MERGE"}));return{data:yield We(this,r),list:T(e,"Title")?this.getParent(wt,this.parentUrl,`getByTitle('${e.Title}')`):wt(this)}}))}getChanges(e){return We(this.clone(wt,"getchanges"),Fe({query:v(Be("SP.ChangeQuery"),e)}))}getItemsByCAMLQuery(e,...t){const r=this.clone(wt,"getitems");return We(r.expand(...t),Fe({query:v(Be("SP.CamlQuery"),e)}))}getListItemChangesSinceToken(e){const t=this.clone(wt,"getlistitemchangessincetoken").usingParser({parse:e=>e.text()});return We(t,Fe({query:v(Be("SP.ChangeLogItemQuery"),e)}))}recycle(){return k(this,void 0,void 0,(function*(){const e=yield We(this.clone(wt,"recycle"));return T(e,"Recycle")?e.Recycle:e}))}renderListData(e){return k(this,void 0,void 0,(function*(){const t=this.clone(wt,"renderlistdata(@viewXml)");t.query.set("@viewXml",`'${e}'`);const r=yield We(t);return JSON.parse(T(r,"RenderListData")?r.RenderListData:r)}))}renderListDataAsStream(e,t=null,r=new Map){T(e,"RenderOptions")&&m(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce(((e,t)=>e+t)));let n={parameters:v(Be("SP.RenderListDataParameters"),e)};f(t)&&(n=v(n,{overrideParameters:v(Be("SP.RenderListDataOverrideParameters"),t)}));const i=this.clone(wt,"RenderListDataAsStream",!0,!0);return r&&r.size>0&&r.forEach(((e,t)=>i.query.set(t,e))),We(i,Fe(n))}renderListFormData(e,t,r){return k(this,void 0,void 0,(function*(){const n=yield We(this.clone(wt,`renderlistformdata(itemid=${e}, formid='${t}', mode='${r}')`));return JSON.parse(T(n,"RenderListFormData")?n.RenderListFormData:n)}))}reserveListItemId(){return k(this,void 0,void 0,(function*(){const e=yield We(this.clone(wt,"reservelistitemid"));return T(e,"ReserveListItemId")?e.ReserveListItemId:e}))}getListItemEntityTypeFullName(){return this.clone(wt,null,!1).select("ListItemEntityTypeFullName").usingCaching({expiration:d(new Date,"day",5),key:`PnPjs-ListEntityName:${this.toUrl()}`,storeName:"local"})().then((e=>e.ListItemEntityTypeFullName))}addValidateUpdateItemUsingPath(e,t,r=!1,n,i){return k(this,void 0,void 0,(function*(){const s={FolderPath:St(t)};f(i)&&(i.leafName&&(s.LeafName=St(i.leafName)),i.objectType&&(s.UnderlyingObjectType=i.objectType));const o=yield We(this.clone(wt,"AddValidateUpdateItemUsingPath()"),Fe({bNewDocumentUpdate:r,checkInComment:n,formValues:e,listItemCreateInfo:v(Be("SP.ListItemCreationInformationUsingPath"),s)}));return T(o,"AddValidateUpdateItemUsingPath")?o.AddValidateUpdateItemUsingPath:o}))}getParentInfos(){return k(this,void 0,void 0,(function*(){const e=yield this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:e.Id,RootFolderServerRelativePath:e.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.RootFolder.UniqueId},ParentWeb:{Id:e.ParentWeb.Id,ServerRelativePath:e.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentWeb.ServerRelativeUrl,Url:e.ParentWeb.Url}}}))}}$([ke("l.update")],Tt.prototype,"update",null),$([ke("l.getChanges")],Tt.prototype,"getChanges",null),$([ke("l.CAMLQuery")],Tt.prototype,"getItemsByCAMLQuery",null),$([ke("l.ChangesSinceToken")],Tt.prototype,"getListItemChangesSinceToken",null),$([ke("l.recycle")],Tt.prototype,"recycle",null),$([ke("l.renderListData")],Tt.prototype,"renderListData",null),$([ke("l.AsStream")],Tt.prototype,"renderListDataAsStream",null),$([ke("l.renderListFormData")],Tt.prototype,"renderListFormData",null),$([ke("l.reserveListItemId")],Tt.prototype,"reserveListItemId",null),$([ke("l.getListItemEntityTypeFullName")],Tt.prototype,"getListItemEntityTypeFullName",null),$([ke("l.addValidateUpdateItemUsingPath")],Tt.prototype,"addValidateUpdateItemUsingPath",null);const wt=Qe(Tt);var Ct,xt;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(Ct||(Ct={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(xt||(xt={})),Y(vt,"lists",It),Y(vt,"siteUserInfoList",wt,"siteuserinfolist"),Y(vt,"defaultDocumentLibrary",wt,"DefaultDocumentLibrary"),Y(vt,"customListTemplates",Ye,"getcustomlisttemplates"),vt.prototype.getList=function(e){return wt(this,`getList('${pt(e)}')`)},vt.prototype.getCatalog=function(e){return k(this,void 0,void 0,(function*(){const t=yield this.clone(bt,`getcatalog(${e})`).select("Id").get();return wt(it(t))}))};let Rt=class extends Je{getById(e){return ke.configure(Ft(this).concat(`(${e})`),"is.getById")}getItemByStringId(e){return ke.configure(Ft(this.parentUrl,`getItemByStringId('${e}')`),"is.getItemByStringId")}skip(e,t=!1){return t?this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`)):this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&p_ID=${e}`)),this}getPaged(){return this.usingParser(new At(this))()}getAll(e=2e3,t="application/json;odata=nometadata"){o.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);const r=Ut(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach(((e,t)=>{/^\$select|filter|top|expand$/i.test(t)&&r.query.set(t,e)})),new Promise(((e,t)=>{const n=[],i=r=>{[].push.apply(n,r.results),r.hasNext?r.getNext().then(i).catch(t):e(n)};r.getPaged().then(i).catch(t)}))}add(e={},t=null){return k(this,void 0,void 0,(function*(){const r=this.addBatchDependency(),n=Fe(v(Be(yield this.ensureListItemEntityTypeName(t)),e)),i=We(this.clone(Ut,""),n).then((e=>({data:e,item:this.getById(e.Id)})));return r(),i}))}ensureListItemEntityTypeName(e){return k(this,void 0,void 0,(function*(){return e||this.getParent(wt).getListItemEntityTypeFullName()}))}};$([ke("is.getPaged")],Rt.prototype,"getPaged",null),$([ke("is.getAll")],Rt.prototype,"getAll",null),$([ke("is.add")],Rt.prototype,"add",null),Rt=$([nt("items")],Rt);const Ut=Qe(Rt);class Dt extends Ze{constructor(){super(...arguments),this.delete=rt("i")}get effectiveBasePermissions(){return ke.configure(Xe(this,"EffectiveBasePermissions"),"i.effectiveBasePermissions")}get effectiveBasePermissionsForUI(){return ke.configure(Xe(this,"EffectiveBasePermissionsForUI"),"i.effectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return ke.configure(et(this,"FieldValuesAsHTML"),"i.fvHTML")}get fieldValuesAsText(){return ke.configure(et(this,"FieldValuesAsText"),"i.fvText")}get fieldValuesForEdit(){return ke.configure(et(this,"FieldValuesForEdit"),"i.fvEdit")}get versions(){return ke.configure(Bt(this),"i.versions")}get list(){return this.getParent(wt,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))}update(e,t="*",r=null){return k(this,void 0,void 0,(function*(){const n=this.addBatchDependency(),i=Fe(v(Be(yield this.ensureListItemEntityTypeName(r)),e),Le({"IF-Match":t,"X-HTTP-Method":"MERGE"}));n();const s=ke.configure(this.clone(Ft).usingParser(new _t),"i.update");return{data:yield We(s,i),item:this}}))}recycle(){return We(this.clone(Ft,"recycle"))}deleteWithParams(e){return k(this,void 0,void 0,(function*(){return We(this.clone(Ft,"DeleteWithParameters"),Fe({parameters:e}))}))}getWopiFrameUrl(e=0){return k(this,void 0,void 0,(function*(){const t=this.clone(Ft,"getWOPIFrameUrl(@action)");t.query.set("@action",e);const r=yield We(t);return T(r,"GetWOPIFrameUrl")?r.GetWOPIFrameUrl:r}))}validateUpdateListItem(e,t=!1){return We(this.clone(Ft,"validateupdatelistitem"),Fe({formValues:e,bNewDocumentUpdate:t}))}getParentInfos(){return k(this,void 0,void 0,(function*(){const e=yield this.select("Id","ParentList/Id","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:e.Id},ParentList:{Id:e.ParentList.Id,RootFolderServerRelativePath:e.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ParentList.ParentWeb.Id,ServerRelativePath:e.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ParentList.ParentWeb.Url}}}))}ensureListItemEntityTypeName(e){return k(this,void 0,void 0,(function*(){return e||this.list.getListItemEntityTypeFullName()}))}}$([ke("i.recycle")],Dt.prototype,"recycle",null),$([ke("i.del-params")],Dt.prototype,"deleteWithParams",null),$([ke("i.getWopiFrameUrl")],Dt.prototype,"getWopiFrameUrl",null),$([ke("i.validateUpdateListItem")],Dt.prototype,"validateUpdateListItem",null);const Ft=Qe(Dt);let Lt=class extends Je{getById(e){return ke.configure($t(this).concat(`(${e})`),"iv.getById")}};Lt=$([nt("versions")],Lt);const Bt=Qe(Lt),$t=Qe(class extends Ze{constructor(){super(...arguments),this.delete=rt("iv")}});class kt{constructor(e,t,r){this.parent=e,this.nextUrl=t,this.results=r}get hasNext(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0}getNext(){return this.hasNext?ke.configure(Ut(this.nextUrl,null).configureFrom(this.parent),"ip.getNext").getPaged():new Promise((e=>e(null)))}}class At extends pe{constructor(e){super(),this._parent=e}parse(e){return new Promise(((t,r)=>{this.handleError(e,r)&&e.json().then((e=>{const r=T(e,"d")&&T(e.d,"__next")?e.d.__next:e["odata.nextLink"];t(new kt(this._parent,r,this.parseODataJSON(e)))}))}))}}class _t extends pe{parse(e){return new Promise(((t,r)=>{this.handleError(e,r)&&t({"odata.etag":e.headers.get("etag")})}))}}Y(Tt,"items",Ut);class Ot{constructor(e,t="config",r="Title",n="Value"){this.web=e,this.listTitle=t,this.keyFieldName=r,this.valueFieldName=n}getConfiguration(){return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName)().then((e=>e.reduce(((e,t)=>(e[t[this.keyFieldName]]=t[this.valueFieldName],e)),{})))}asCaching(e=`pnp_configcache_splist_${this.web.toUrl()}+${this.listTitle}`){return new z(this,e)}}var Et,Nt,Mt;function qt(e){return v(Be("Collection(SP.KeyValue)"),{results:Object.keys(e).map((t=>v(Be("SP.KeyValue"),{Key:t,Value:Reflect.get(e,t),ValueType:"Edm.String"})))})}!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(Et||(Et={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(Nt||(Nt={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(Mt||(Mt={}));const jt=/["*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,Wt=/["#%*:<>?/\\|\x00-\x1f\x7f-\x9f]/g;function Ht(e,t=!1){return t?Wt.test(e):jt.test(e)}function Vt(e,t="",r=!1){return r?e.replace(Wt,t):e.replace(jt,t)}Reflect.defineProperty(ht.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>bt(t).configure(e).setRuntime(r)))}}),ht.prototype.createBatch=function(){return this.web.createBatch()};const Gt=new class extends ht{crossDomainSite(e,t){return this._cdImpl(yt,e,t,"site")}crossDomainWeb(e,t){return this._cdImpl(bt,e,t,"web")}_cdImpl(e,t,r,n){if(!b(t))throw Error("The addInWebUrl parameter must be an absolute url.");if(!b(r))throw Error("The hostWebUrl parameter must be an absolute url.");const i=e(h(t,"_api/SP.AppContextSite(@target)"),n);return i.query.set("@target","'"+encodeURIComponent(r)+"'"),this.childConfigHook((({options:e,runtime:t})=>i.configure(e).setRuntime(t)))}};function zt(e,t=B){t.assign(e)}F((e=>{const t=e.get("graph"),r=Object.assign({},{fetchClientFactory:()=>{const t=e.get("spfxContext");if(f(t))return new j(t);throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context.")}},t);e.assign({graph:r})}));class Qt{constructor(...e){e[0]instanceof L?this._runtime=e[0]:(this._runtime=e.length>1&&e[1]instanceof L?e[1]:B,this._impl=e[0]),this._impl=this._runtime.get("graph").fetchClientFactory()}fetch(e,t={}){var r;const n=new Headers;_(n,null===(r=this._runtime.get("graph"))||void 0===r?void 0:r.headers),_(n,t.headers),n.has("Content-Type")||n.append("Content-Type","application/json"),n.has("SdkVersion")||n.append("SdkVersion","PnPCoreJS/2.1.0");const i=v(t,{headers:n});return this.fetchRaw(e,i)}fetchRaw(e,t={}){const r=new Headers;_(r,t.headers),t=v(t,{headers:r});const n=r=>{this._impl.fetch(e,t).then((e=>r.resolve(e))).catch((e=>{429!==e.status&&503!==e.status&&504!==e.status&&r.reject(e);const t=r.delay;r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(e),setTimeout(u(this,n,r),t)}))};return new Promise(((e,t)=>{const r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};n.call(this,r)}))}get(e,t={}){const r=v(t,{method:"GET"});return this.fetch(e,r)}post(e,t={}){const r=v(t,{method:"POST"});return this.fetch(e,r)}patch(e,t={}){const r=v(t,{method:"PATCH"});return this.fetch(e,r)}delete(e,t={}){const r=v(t,{method:"DELETE"});return this.fetch(e,r)}}function Kt(e,t=B){var r,n,i;return k(this,void 0,void 0,(function*(){if(b(e))return e;let s=null===(r=t.get("graph"))||void 0===r?void 0:r.baseUrl;if(!S(s))return h(s,e);const o=t.get("spfxContext");if(f(o))try{const t=yield o.msGraphClientFactory.getClient();if(s=null===(i=null===(n=t)||void 0===n?void 0:n.constructor)||void 0===i?void 0:i._graphBaseUrl,!S(s))return h(s,e)}catch(e){}return h("https://graph.microsoft.com",e)}))}class Xt extends Q{constructor(e="v1.0/$batch",t=20,r=B){super(),this.batchUrl=e,this.maxRequests=t,this.runtime=r}setRuntime(e){return this.runtime=e,this}executeImpl(){return k(this,void 0,void 0,(function*(){if(o.write(`[${this.batchId}] (${(new Date).getTime()}) Executing batch with ${this.requests.length} requests.`,1),this.requests.length<1)return o.write("Resolving empty batch.",1),Promise.resolve();const e=new Qt(this.runtime),t=this.requests.slice();for(;t.length>0;){const r=t.splice(0,this.maxRequests),n={body:I({requests:this.formatRequests(r)}),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};o.write(`[${this.batchId}] (${(new Date).getTime()}) Sending batch request.`,1);const i=yield Kt(this.batchUrl,this.runtime);yield e.fetch(i,n).then((e=>e.json())).then((e=>this.parseResponse(r,e))).then((e=>{o.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched requests.`,1),e.responses.reduce(((e,t,n)=>{const i=r[n];return o.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched request ${i.method} ${i.url}.`,0),e.then((()=>i.parser.parse(t).then(i.resolve).catch(i.reject)))}),Promise.resolve())})).catch((e=>{throw e}))}}))}makeUrlRelative(e){if(!b(e))return e;let t=e.indexOf("/v1.0/");return t<0?(t=e.indexOf("/beta/"),t>-1?e.substr(t+6):e):e.substr(t+5)}formatRequests(e){return e.map(((e,t)=>{var r;let n={id:""+ ++t,method:e.method,url:this.makeUrlRelative(e.url)},i={};return i=v(i,null===(r=this.runtime.get("graph"))||void 0===r?void 0:r.headers),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(i=v(i,e.options.headers)),"GET"!==e.method&&(i["Content-Type"]="application/json"),void 0!==e.options.body&&null!==e.options.body&&(n=v(n,{body:JSON.parse(e.options.body)}))),n=v(n,{headers:i}),n}))}parseResponse(e,t){return new Promise(((r,n)=>{if(T(t,"error"))return n(Error(`Error Porcessing Batch: (${t.error.code}) ${t.error.message}`));const i=new Array(e.length).fill(null);for(let e=0;e<t.responses.length;++e){const r=t.responses[e],n=parseInt(r.id,10)-1;204===r.status?i[n]=new Response:i[n]=new Response(JSON.stringify(r.body),r)}r({nextLink:t.nextLink,responses:i})}))}}class Jt{constructor(e={},t="v1.0",r=B){this._options=e,this._baseUrl=t,this._runtime=r}createBatch(){return(new Xt).setRuntime(this._runtime)}setup(e){e.pageContext?zt({spfxContext:e},this._runtime):zt(e,this._runtime)}createIsolated(e){return k(this,void 0,void 0,(function*(){e=Object.assign({baseUrl:"v1.0",cloneGlobal:!0,config:{},options:{}},e||{});const{baseUrl:t,cloneGlobal:r,options:n,config:i}=e,s=r?new L(B.export()):new L;return s.assign(i),new Jt(n,t,s)}))}childConfigHook(e){return e({options:this._options,baseUrl:this._baseUrl,runtime:this._runtime})}}const Yt=new Jt;class Zt{static ensure(e,t){const r=[Zt.Beta,Zt.V1];let n=new RegExp(t,"i");const i=r.filter((e=>!n.test(e))).map((e=>e.replace(".","\\.")));return n=new RegExp(`/?(${i.join("|")})/?`,"ig"),e.replace(n,`/${t}/`)}}function er(e){rr=y(e)?()=>e:tr}Zt.Beta="beta",Zt.V1="v1.0";const tr=e=>()=>new Qt(e);let rr=tr;const nr=e=>function(t,r){return k(this,void 0,void 0,(function*(){const n=t.getRuntime(),i=De(rr(n))(e),s=Se(t.data),o=f(s.batch)?s.batch.addDependency():()=>{},a=yield Kt(t.toUrlAndQuery(),n);return O(s.options,r),i(Object.assign({},s,{batchDependency:o,url:a}))}))},ir=(e,t)=>nr("GET")(e,t),sr=(e,t)=>nr("POST")(e,t),or=(e,t)=>nr("DELETE")(e,t),ar=(e,t)=>nr("PATCH")(e,t),lr=(e,t)=>nr("PUT")(e,t),cr=e=>de(e);class ur extends Pe{constructor(e,t){let r="",n="";const i=new Map;"string"==typeof e?(n=e,r=h(n,t)):(n=e.toUrl(),r=h(n,t)),super({parentUrl:n,query:i,url:r}),"string"!=typeof e&&this.configureFrom(e)}select(...e){return e.length>0&&this.query.set("$select",e.map(encodeURIComponent).join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.map(encodeURIComponent).join(",")),this}defaultAction(e){return ir(this,e)}get(e){return ir(this,e)}toUrlAndQuery(){let e=this.toUrl();if(this.query.size>0){const t=e.indexOf("?")>-1?"&":"?";e+=`${t}${Array.from(this.query).map((e=>e[0]+"="+e[1])).join("&")}`}return e}setEndpoint(e){return this.data.url=Zt.ensure(this.data.url,e),this}clone(e,t,r=!0,n=!1){return super.cloneTo(e(this,t),{includeBatch:r,includeQuery:n})}getParent(e,t=this.parentUrl,r){return new e(t,r)}}const dr=cr(ur);class hr extends ur{filter(e){return this.query.set("$filter",e),this}orderBy(e,t=!0){const r="$orderby",n=this.query.has(r)?this.query.get(r).split(","):[];return n.push(`${encodeURIComponent(e)} ${t?"asc":"desc"}`),this.query.set(r,n.join(",")),this}top(e){return this.query.set("$top",e.toString()),this}skip(e){return this.query.set("$skip",e.toString()),this}skipToken(e){return this.query.set("$skiptoken",e),this}get count(){return this.query.set("$count","true"),this}}const pr=cr(hr),gr=cr(class extends hr{search(e){return this.query.set("$search",e),this}});class yr extends ur{}const fr=cr(yr);let mr=class extends Je{getByName(e){if(/%#/.test(e))throw Error("For file names containing % or # please use web.getFileByServerRelativePath");return ke.configure(Sr(this).concat(`('${pt(e)}')`),"fis.getByName")}add(e,t,r=!0){return k(this,void 0,void 0,(function*(){return{data:yield We(vr(this,`add(overwrite=${r},url='${pt(e)}')`),{body:t}),file:this.getByName(e)}}))}addUsingPath(e,t,r={Overwrite:!1}){return k(this,void 0,void 0,(function*(){const n=[`AddUsingPath(decodedurl='${pt(e)}'`];r&&(r.Overwrite&&n.push(",Overwrite=true"),r.AutoCheckoutOnInvalidData&&n.push(",AutoCheckoutOnInvalidData=true"),S(r.XorHash)||n.push(`,XorHash=${pt(r.XorHash)}`)),n.push(")");const i=yield We(vr(this,n.join("")),{body:t});return{data:i,file:Sr(it(i))}}))}addChunked(e,t,r,n=!0,i=10485760){return k(this,void 0,void 0,(function*(){const s=yield We(this.clone(vr,`add(overwrite=${n},url='${pt(e)}')`,!1)),o=Sr(it(s));return yield o.setContentChunked(t,r,i)}))}addTemplateFile(e,t){return k(this,void 0,void 0,(function*(){const r=yield We(this.clone(vr,`addTemplateFile(urloffile='${pt(e)}',templatefiletype=${t})`,!1));return{data:r,file:Sr(it(r))}}))}};$([ke("fis.add")],mr.prototype,"add",null),$([ke("fis.addUsingPath")],mr.prototype,"addUsingPath",null),$([ke("fis.addChunked")],mr.prototype,"addChunked",null),$([ke("fis.addTemplateFile")],mr.prototype,"addTemplateFile",null),mr=$([nt("files")],mr);const vr=Qe(mr);class br extends Ze{constructor(){super(...arguments),this.delete=rt("fi")}get listItemAllFields(){return ke.configure(et(this,"listItemAllFields"),"fi.listItemAllFields")}get versions(){return ke.configure(Ir(this),"fi.versions")}approve(e=""){return We(this.clone(Sr,`approve(comment='${pt(e)}')`))}cancelUpload(e){return We(this.clone(Sr,`cancelUpload(uploadId=guid'${e}')`,!1))}checkin(e="",t=wr.Major){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return We(this.clone(Sr,`checkin(comment='${pt(e)}',checkintype=${t})`))}checkout(){return We(this.clone(Sr,"checkout"))}copyTo(e,t=!0){return We(this.clone(Sr,`copyTo(strnewurl='${pt(e)}',boverwrite=${t})`))}copyByPath(e,t,r=!1){return k(this,void 0,void 0,(function*(){const{ServerRelativeUrl:n,"odata.id":i}=yield this.select("ServerRelativeUrl")(),s=$e(i),o=s.replace("://","___").split("/")[0].replace("___","://");yield We(Sr(s,`/_api/SP.MoveCopyUtil.CopyFileByPath(overwrite=@a1)?@a1=${t}`),Fe({destPath:St(b(e)?e:`${o}${e}`),options:{KeepBoth:r,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:St(b(n)?n:`${o}${n}`)}))}))}deny(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return We(this.clone(Sr,`deny(comment='${pt(e)}')`))}moveTo(e,t=Cr.Overwrite){return We(this.clone(Sr,`moveTo(newurl='${pt(e)}',flags=${t})`))}moveByPath(e,t,r=!1){return k(this,void 0,void 0,(function*(){const{ServerRelativeUrl:n,"odata.id":i}=yield this.select("ServerRelativeUrl")(),s=$e(i),o=s.replace("://","___").split("/")[0].replace("___","://");yield We(Sr(s,`/_api/SP.MoveCopyUtil.MoveFileByPath(overwrite=@a1)?@a1=${t}`),Fe({destPath:St(b(e)?e:`${o}${e}`),options:{KeepBoth:r,ResetAuthorAndCreatedOnCopy:!1,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:St(b(n)?n:`${o}${n}`)}))}))}publish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return We(this.clone(Sr,`publish(comment='${pt(e)}')`))}recycle(){return We(this.clone(Sr,"recycle"))}deleteWithParams(e){return k(this,void 0,void 0,(function*(){return We(this.clone(Sr,"DeleteWithParameters"),Fe({parameters:e}))}))}undoCheckout(){return We(this.clone(Sr,"undoCheckout"))}unpublish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return We(this.clone(Sr,`unpublish(comment='${pt(e)}')`))}exists(){return k(this,void 0,void 0,(function*(){try{return(yield this.clone(Sr).select("Exists")()).Exists}catch(e){return!1}}))}getText(){return this.clone(Sr,"$value",!1).usingParser(new ge)(Le({binaryStringResponseBody:"true"}))}getBlob(){return this.clone(Sr,"$value",!1).usingParser(new ye)(Le({binaryStringResponseBody:"true"}))}getBuffer(){return this.clone(Sr,"$value",!1).usingParser(new me)(Le({binaryStringResponseBody:"true"}))}getJSON(){return this.clone(Sr,"$value",!1).usingParser(new fe)(Le({binaryStringResponseBody:"true"}))}setContent(e){return k(this,void 0,void 0,(function*(){return yield We(this.clone(Sr,"$value",!1),{body:e,headers:{"X-HTTP-Method":"PUT"}}),Sr(this)}))}getItem(...e){return k(this,void 0,void 0,(function*(){const t=this.listItemAllFields,r=yield t.select(...e)();return v(Ft(it(r)),r)}))}setContentChunked(e,t,r=10485760){return k(this,void 0,void 0,(function*(){y(t)||(t=()=>null);const n=e.size,i=parseInt((n/r).toString(),10)+(n%r==0?1:0),s=g();t({uploadId:s,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:n,stage:"starting",totalBlocks:i});let o=yield this.startUpload(s,e.slice(0,r));for(let a=2;a<i;a++)t({uploadId:s,blockNumber:a,chunkSize:r,currentPointer:o,fileSize:n,stage:"continue",totalBlocks:i}),o=yield this.continueUpload(s,o,e.slice(o,o+r));return t({uploadId:s,blockNumber:i,chunkSize:r,currentPointer:o,fileSize:n,stage:"finishing",totalBlocks:i}),this.finishUpload(s,o,e.slice(o))}))}startUpload(e,t){return k(this,void 0,void 0,(function*(){let r=yield We(this.clone(Sr,`startUpload(uploadId=guid'${e}')`,!1),{body:t});return"object"==typeof r&&(r=r.StartUpload),parseFloat(r)}))}continueUpload(e,t,r){return k(this,void 0,void 0,(function*(){let n=yield We(this.clone(Sr,`continueUpload(uploadId=guid'${e}',fileOffset=${t})`,!1),{body:r});return"object"==typeof n&&(n=n.ContinueUpload),parseFloat(n)}))}finishUpload(e,t,r){return k(this,void 0,void 0,(function*(){const n=yield We(this.clone(Sr,`finishUpload(uploadId=guid'${e}',fileOffset=${t})`,!1),{body:r});return{data:n,file:Sr(it(n))}}))}}$([ke("fi.approve")],br.prototype,"approve",null),$([ke("fi.cancelUpload")],br.prototype,"cancelUpload",null),$([ke("fi.checkin")],br.prototype,"checkin",null),$([ke("fi.checkout")],br.prototype,"checkout",null),$([ke("fi.copyTo")],br.prototype,"copyTo",null),$([ke("fi.copyByPath")],br.prototype,"copyByPath",null),$([ke("fi.deny")],br.prototype,"deny",null),$([ke("fi.moveTo")],br.prototype,"moveTo",null),$([ke("fi.moveByPath")],br.prototype,"moveByPath",null),$([ke("fi.publish")],br.prototype,"publish",null),$([ke("fi.recycle")],br.prototype,"recycle",null),$([ke("fi.del-params")],br.prototype,"deleteWithParams",null),$([ke("fi.undoCheckout")],br.prototype,"undoCheckout",null),$([ke("fi.unpublish")],br.prototype,"unpublish",null),$([ke("fi.exists")],br.prototype,"exists",null),$([ke("fi.getText")],br.prototype,"getText",null),$([ke("fi.getBlob")],br.prototype,"getBlob",null),$([ke("fi.getBuffer")],br.prototype,"getBuffer",null),$([ke("fi.getJSON")],br.prototype,"getJSON",null),$([ke("fi.setContent")],br.prototype,"setContent",null),$([ke("fi.getItem")],br.prototype,"getItem",null),$([ke("fi.startUpload")],br.prototype,"startUpload",null),$([ke("fi.continueUpload")],br.prototype,"continueUpload",null),$([ke("fi.finishUpload")],br.prototype,"finishUpload",null);const Sr=Qe(br);let Pr=class extends Je{getById(e){return ke.configure(Tr(this).concat(`(${e})`),"vers.getById")}deleteAll(){return We(Ir(this,"deleteAll"))}deleteById(e){return We(this.clone(Ir,`deleteById(vid=${e})`))}recycleByID(e){return We(this.clone(Ir,`recycleByID(vid=${e})`))}deleteByLabel(e){return We(this.clone(Ir,`deleteByLabel(versionlabel='${pt(e)}')`))}recycleByLabel(e){return We(this.clone(Ir,`recycleByLabel(versionlabel='${pt(e)}')`))}restoreByLabel(e){return We(this.clone(Ir,`restoreByLabel(versionlabel='${pt(e)}')`))}};$([ke("vers.deleteAll")],Pr.prototype,"deleteAll",null),$([ke("vers.deleteById")],Pr.prototype,"deleteById",null),$([ke("vers.recycleByID")],Pr.prototype,"recycleByID",null),$([ke("vers.deleteByLabel")],Pr.prototype,"deleteByLabel",null),$([ke("vers.recycleByLabel")],Pr.prototype,"recycleByLabel",null),$([ke("vers.restoreByLabel")],Pr.prototype,"restoreByLabel",null),Pr=$([nt("versions")],Pr);const Ir=Qe(Pr),Tr=Qe(class extends Ze{constructor(){super(...arguments),this.delete=rt("ver")}});var wr,Cr,xr;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(wr||(wr={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(Cr||(Cr={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(xr||(xr={}));const Rr=Qe(class extends Je{constructor(e,t="_api/web/tenantappcatalog/AvailableApps"){super($e("string"==typeof e?e:e.toUrl()),t)}getAppById(e){return ke.configure(Dr(this,`getById('${e}')`),"ac.getAppById")}syncSolutionToTeams(e,t=!1){return k(this,void 0,void 0,(function*(){let r=null;const n=$e(this.toUrl());if(t)r=e;else{const t=bt(n),i=(yield t.lists.select("Id").filter("EntityTypeName eq 'AppCatalog'")())[0].Id,s=yield t.lists.getById(i).items.filter(`AppProductID eq '${e}'`).top(1)();if(!(s&&s.length>0))throw Error(`Did not find the app with id ${e} in the appcatalog.`);r=s[0].Id}const i=ke.configure(Rr(n,`_api/web/tenantappcatalog/SyncSolutionToTeams(id=${r})`),"ac.syncSolutionToTeams");return yield We(i,{})}))}add(e,t,r=!0){return k(this,void 0,void 0,(function*(){const n=ke.configure(Rr($e(this.toUrl()),`_api/web/tenantappcatalog/add(overwrite=${r},url='${e}')`),"ac.add"),i=yield We(n,{body:t,headers:{binaryStringRequestBody:"true"}});return{data:i,file:Sr(it(i))}}))}});class Ur extends Ze{deploy(e=!1){return this.do(`Deploy(${e})`)}retract(){return this.do("Retract")}install(){return this.do("Install")}uninstall(){return this.do("Uninstall")}upgrade(){return this.do("Upgrade")}remove(){return this.do("Remove")}do(e){return We(this.clone(Dr,e))}}$([ke("app.deploy")],Ur.prototype,"deploy",null),$([ke("app.retract")],Ur.prototype,"retract",null),$([ke("app.install")],Ur.prototype,"install",null),$([ke("app.uninstall")],Ur.prototype,"uninstall",null),$([ke("app.upgrade")],Ur.prototype,"upgrade",null),$([ke("app.remove")],Ur.prototype,"remove",null);const Dr=Qe(Ur);vt.prototype.getAppCatalog=function(e){return Rr(e||this)},ht.prototype.getTenantAppCatalogWeb=function(){return k(this,void 0,void 0,(function*(){return this.childConfigHook((({options:e,runtime:t})=>k(this,void 0,void 0,(function*(){const r=yield Xe("/","_api/SP_TenantSettings_Current").configure(e).setRuntime(t)();return bt(r.CorporateCatalogUrl).configure(e).setRuntime(t)}))))}))};let Fr=class extends Je{getByName(e){const t=ke.configure($r(this),"ats.getByName");return t.concat(`('${e}')`),t}add(e,t){return k(this,void 0,void 0,(function*(){return{data:yield We(this.clone(Lr,`add(FileName='${e}')`,!1),{body:t}),file:this.getByName(e)}}))}addMultiple(e){return k(this,void 0,void 0,(function*(){for(let t=0;t<e.length;t++)yield this.add(e[t].name,e[t].content)}))}deleteMultiple(...e){return k(this,void 0,void 0,(function*(){for(let t=0;t<e.length;t++)yield this.getByName(e[t]).delete()}))}recycleMultiple(...e){return k(this,void 0,void 0,(function*(){for(let t=0;t<e.length;t++)yield this.getByName(e[t]).recycle()}))}};$([ke("ats.add")],Fr.prototype,"add",null),$([ke("ats.addMultiple")],Fr.prototype,"addMultiple",null),$([ke("ats.deleteMultiple")],Fr.prototype,"deleteMultiple",null),$([ke("ats.recycleMultiple")],Fr.prototype,"recycleMultiple",null),Fr=$([nt("AttachmentFiles")],Fr);const Lr=Qe(Fr);class Br extends Ze{constructor(){super(...arguments),this.delete=rt("at")}getText(){return this.getParsed(new ge)}getBlob(){return this.getParsed(new ye)}getBuffer(){return this.getParsed(new me)}getJSON(){return this.getParsed(new fe)}setContent(e){return k(this,void 0,void 0,(function*(){return yield We(this.clone($r,"$value",!1),Le({"X-HTTP-Method":"PUT"},{body:e})),$r(this)}))}recycle(e="*"){return We(this.clone($r,"recycleObject"),Le({"IF-Match":e,"X-HTTP-Method":"DELETE"}))}getParsed(e){return this.clone($r,"$value",!1).usingParser(e)()}}$([ke("at.getText")],Br.prototype,"getText",null),$([ke("at.getBlob")],Br.prototype,"getBlob",null),$([ke("at.getBuffer")],Br.prototype,"getBuffer",null),$([ke("at.getJSON")],Br.prototype,"getJSON",null),$([ke("at.setContent")],Br.prototype,"setContent",null),$([ke("at.recycle")],Br.prototype,"recycle",null);const $r=Qe(Br);function kr(e){return e.length<1?1:Math.max.apply(null,e.map((e=>e.order)))+1}function Ar(e){for(let t=0;t<e.length;t++)e[t].order=t+1,T(e[t],"columns")?Ar(e[t].columns):T(e[t],"controls")&&Ar(e[t].controls)}Y(Dt,"attachmentFiles",Lr),vt.prototype.getFileByServerRelativeUrl=function(e){return Sr(this,`getFileByServerRelativeUrl('${pt(e)}')`)},vt.prototype.getFileByServerRelativePath=function(e){return Sr(this,`getFileByServerRelativePath(decodedUrl='${pt(e)}')`)},vt.prototype.getFileById=function(e){return Sr(this,`getFileById('${e}')`)},vt.prototype.getFileByUrl=function(e){return Sr(this,`getFileByUrl('!@p1::${pt(e)}')`)};let _r=class extends Je{add(e){return k(this,void 0,void 0,(function*(){"string"==typeof e&&(e={text:e});const t=Fe(v(Be("Microsoft.SharePoint.Comments.comment"),e)),r=yield We(this.clone(Or,null),t);return v(this.getById(r.id),r)}))}getById(e){return ke.configure(Nr(this).concat(`(${e})`),"coms.getById")}clear(){return We(ke.configure(this.clone(Or,"DeleteAll"),"coms.clear"))}};$([ke("coms.add")],_r.prototype,"add",null),_r=$([nt("comments")],_r);const Or=Qe(_r);class Er extends Ze{get replies(){return ke.configure(qr(this),"com.replies")}like(){return We(this.clone(Nr,"Like"))}unlike(){return We(this.clone(Nr,"Unlike"))}delete(){return We(this.clone(Nr,"DeleteComment"))}}$([ke("com.like")],Er.prototype,"like",null),$([ke("com.unlike")],Er.prototype,"unlike",null),$([ke("com.delete")],Er.prototype,"delete",null);const Nr=Qe(Er);let Mr=class extends Je{add(e){return k(this,void 0,void 0,(function*(){"string"==typeof e&&(e={text:e});const t=Fe(v(Be("Microsoft.SharePoint.Comments.comment"),e)),r=yield We(this.clone(qr,null),t);return v(Nr(it(r)),r)}))}};$([ke("reps.add")],Mr.prototype,"add",null),Mr=$([nt("replies")],Mr);const qr=Qe(Mr);var jr;function Wr(e,t){return Vr($e(e.toUrl()),t).configureFrom(e)}Y(Dt,"comments",Or),Dt.prototype.getLikedBy=function(){return We(this.clone(Ft,"likedBy"))},Dt.prototype.like=function(){return k(this,void 0,void 0,(function*(){const e=yield this.getParentInfos(),t=h($e(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+`?@a1='{${e.ParentList.Id}}'&@a2='${e.Item.Id}'&@a3=true`;return We(Xe(t))}))},Dt.prototype.unlike=function(){return k(this,void 0,void 0,(function*(){const e=yield this.getParentInfos(),t=h($e(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+`?@a1='{${e.ParentList.Id}}'&@a2='${e.Item.Id}'&@a3=false`;return We(Xe(t))}))},Dt.prototype.getLikedByInformation=function(){return this.clone(Ft,"likedByInformation").expand("likedby")()},function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(jr||(jr={}));class Hr extends Ke{constructor(e,t,r,n=!1,i=[],s=!1){super(e,t),this.json=r,this.sections=i,this.commentsDisabled=s,this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,"string"==typeof e?(this.data.parentUrl="",this.data.url=h($e(e),t)):this.assign(Wr(e,null),t),this._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},this._layoutPart=Hr.getDefaultLayoutPart(),void 0===r||n||this.fromJSON(r)}static getDefaultLayoutPart(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authorByline:[],authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:""},reservedHeight:280,serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}}get pageLayout(){return this.json.PageLayoutType}set pageLayout(e){this.json.PageLayoutType=e}get bannerImageUrl(){return this.json.BannerImageUrl}set bannerImageUrl(e){this.setBannerImage(e)}get thumbnailUrl(){return this._pageSettings.pageSettingsSlice.isDefaultThumbnail?this.json.BannerImageUrl:this.json.BannerThumbnailUrl}set thumbnailUrl(e){this.json.BannerThumbnailUrl=e,this._bannerImageThumbnailUrlDirty=!0,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!1}get topicHeader(){return f(this.json.TopicHeader)?this.json.TopicHeader:""}set topicHeader(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,S(e)&&(this.showTopicHeader=!1)}get title(){return this._layoutPart.properties.title}set title(e){this.json.Title=e,this._layoutPart.properties.title=e}get reservedHeight(){return this._layoutPart.reservedHeight}set reservedHeight(e){this._layoutPart.reservedHeight=e}get description(){return this.json.Description}set description(e){if(!S(e)&&e.length>255)throw Error("Modern Page description is limited to 255 chars.");this.json.Description=e,T(this._pageSettings,"htmlAttributes")||(this._pageSettings.htmlAttributes=[]),this._pageSettings.htmlAttributes.indexOf("modifiedDescription")<0&&this._pageSettings.htmlAttributes.push("modifiedDescription"),this._pageSettings.pageSettingsSlice.isDefaultDescription=!1}get layoutType(){return this._layoutPart.properties.layoutType}set layoutType(e){this._layoutPart.properties.layoutType=e}get headerTextAlignment(){return this._layoutPart.properties.textAlignment}set headerTextAlignment(e){this._layoutPart.properties.textAlignment=e}get showTopicHeader(){return this._layoutPart.properties.showTopicHeader}set showTopicHeader(e){this._layoutPart.properties.showTopicHeader=e}get showPublishDate(){return this._layoutPart.properties.showPublishDate}set showPublishDate(e){this._layoutPart.properties.showPublishDate=e}get hasVerticalSection(){return this.sections.findIndex((e=>2===e.layoutIndex))>-1}get authorByLine(){return m(this.json.AuthorByline)&&this.json.AuthorByline.length>0?this.json.AuthorByline[0]:null}get verticalSection(){return this.hasVerticalSection?this.addVerticalSection():null}addSection(){const e=new Qr(this,kr(this.sections),1);return this.sections.push(e),e}addVerticalSection(){const e=this.sections.findIndex((e=>2===e.layoutIndex));if(e>-1)return this.sections[e];const t=new Qr(this,kr(this.sections),2);return this.sections.push(t),t}fromJSON(e){this.json=e;const t=JSON.parse(e.CanvasContent1),r=JSON.parse(e.LayoutWebpartsContent);return r&&r.length>0&&(this._layoutPart=r[0]),this.setControls(t),this}load(){return k(this,void 0,void 0,(function*(){const e=yield this.getItem("Id","CommentsDisabled"),t=yield Xe(this,`_api/sitepages/pages(${e.Id})`)();return this.commentsDisabled=e.CommentsDisabled,this.fromJSON(t)}))}save(e=!0){return k(this,void 0,void 0,(function*(){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");if(this._bannerImageDirty){const e=this.bannerImageUrl;let t,r;const n=bt($e(this.toUrl())),i=n.createBatch();n.getFileByServerRelativePath(e.replace(/%20/gi," ")).select("ListId","WebId","UniqueId","Name","SiteId").inBatch(i)().then((e=>t=e)),n.select("Url").inBatch(i)().then((e=>r=e.Url)),yield i.execute();const s=Xe(r,"_layouts/15/getpreview.ashx");s.query.set("guidSite",`${t.SiteId}`),s.query.set("guidWeb",`${t.WebId}`),s.query.set("guidFile",`${t.UniqueId}`),this.bannerImageUrl=s.toUrlAndQuery(),f(this._layoutPart.serverProcessedContent)||(this._layoutPart.serverProcessedContent={}),this._layoutPart.serverProcessedContent.imageSources={imageSource:e},f(this._layoutPart.serverProcessedContent.customMetadata)||(this._layoutPart.serverProcessedContent.customMetadata={}),this._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:t.ListId,siteId:t.SiteId,uniqueId:t.UniqueId,webId:t.WebId},this._layoutPart.properties.webId=t.WebId,this._layoutPart.properties.siteId=t.SiteId,this._layoutPart.properties.listId=t.ListId,this._layoutPart.properties.uniqueId=t.UniqueId}this.json.IsPageCheckedOutToCurrentUser||(yield We(Wr(this,`_api/sitepages/pages(${this.json.Id})/checkoutpage`)));let t=Object.assign(Be("SP.Publishing.SitePage"),{AuthorByline:this.json.AuthorByline||[],CanvasContent1:this.getCanvasContent1(),Description:this.description,LayoutWebpartsContent:this.getLayoutWebpartsContent(),Title:this.title,TopicHeader:this.topicHeader});(this._bannerImageDirty||this._bannerImageThumbnailUrlDirty)&&(t=v(t,{BannerImageUrl:this._bannerImageThumbnailUrlDirty?this.thumbnailUrl:this.bannerImageUrl}));const r=Wr(this,`_api/sitepages/pages(${this.json.Id})/savepage`);yield We(r,Le({"if-match":"*"},Fe(t)));let n=!0;return e&&(n=yield We(Wr(this,`_api/sitepages/pages(${this.json.Id})/publish`)),n&&(this.json.IsPageCheckedOutToCurrentUser=!1)),this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,n}))}discardPageCheckout(){return k(this,void 0,void 0,(function*(){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");const e=yield We(Wr(this,`_api/sitepages/pages(${this.json.Id})/discardPage`),Fe(Be("SP.Publishing.SitePage")));this.fromJSON(e)}))}promoteToNews(){return k(this,void 0,void 0,(function*(){return this.promoteNewsImpl("promoteToNews")}))}findControlById(e){return this.findControl((t=>t.id===e))}findControl(e){for(let t=0;t<this.sections.length;t++)for(let r=0;r<this.sections[t].columns.length;r++)for(let n=0;n<this.sections[t].columns[r].controls.length;n++)if(e(this.sections[t].columns[r].controls[n]))return this.sections[t].columns[r].controls[n];return null}copy(e,t,r,n=!0,i){return k(this,void 0,void 0,(function*(){const s=yield zr(e,t,r,this.pageLayout,i);if(s.setControls(this.getControls()),!S(this.json.BannerImageUrl)){const e=new URL(this.json.BannerImageUrl),t=e=>e.replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/g,"$1-$2-$3-$4-$5");if(e.searchParams.has("guidSite")&&e.searchParams.has("guidWeb")&&e.searchParams.has("guidFile")){const r=t(e.searchParams.get("guidSite")),n=t(e.searchParams.get("guidWeb")),i=t(e.searchParams.get("guidFile")),o=yt($e(this.toUrl()));if((yield o.select("Id")()).Id===r){const e=yield o.openWebById(n),t=yield e.web.getFileById(i).select("ServerRelativeUrl")(),r={};this._layoutPart.properties&&(T(this._layoutPart.properties,"translateX")&&(r.translateX=this._layoutPart.properties.translateX),T(this._layoutPart.properties,"translateY")&&(r.translateY=this._layoutPart.properties.translateY),T(this._layoutPart.properties,"imageSourceType")&&(r.imageSourceType=this._layoutPart.properties.imageSourceType),T(this._layoutPart.properties,"altText")&&(r.altText=this._layoutPart.properties.altText)),s.setBannerImage(t.ServerRelativeUrl,r)}}}return yield s.save(n),s}))}setBannerImage(e,t){b(e)&&(e=e.replace(/^https?:\/\/[a-z0-9.]*?\.[a-z]{2,3}\//i,"/")),this.json.BannerImageUrl=e,this._bannerImageDirty=!0,this._bannerImageThumbnailUrlDirty||(this.thumbnailUrl=e,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!0),this._layoutPart.properties.imageSourceType=2,f(t)&&(T(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),T(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),T(t,"imageSourceType")&&(this._layoutPart.properties.imageSourceType=t.imageSourceType),T(t,"altText")&&(this._layoutPart.properties.altText=t.altText))}setBannerImageFromExternalUrl(e,t){return k(this,void 0,void 0,(function*(){const r=new URL(e),n=this.json.FileName.replace(/\.[^/.]+$/,""),i=r.pathname.split(/[\\/]/i).pop(),s=Wr(this,"_api/sitepages/AddImageFromExternalUrl");s.query.set("imageFileName",`'${encodeURIComponent(i)}'`),s.query.set("pageName",`'${encodeURIComponent(n)}'`),s.query.set("externalUrl",`'${encodeURIComponent(e)}'`),s.select("ServerRelativeUrl");const o=yield We(s);this.setBannerImage(o.ServerRelativeUrl,t)}))}setAuthorById(e){return k(this,void 0,void 0,(function*(){const t=yield Ye($e(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter(`Id eq ${e}`).select("LoginName")();if(t.length<1)throw Error(`Could not find user with id ${e}.`);return this.setAuthorByLoginName(t[0].LoginName)}))}setAuthorByLoginName(e){return k(this,void 0,void 0,(function*(){const t=yield Ye($e(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter(`LoginName eq '${encodeURIComponent(e)}'`).select("UserPrincipalName","Title")();if(t.length<1)throw Error(`Could not find user with login name '${e}'.`);this.json.AuthorByline=[e],this._layoutPart.properties.authorByline=[e],this._layoutPart.properties.authors=[{id:e,name:t[0].Title,role:"",upn:t[0].UserPrincipalName}]}))}getItem(...e){return k(this,void 0,void 0,(function*(){const t=Wr(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id"),r=yield We(t),n=wt(r["odata.id"]).configureFrom(this).items.getById(this.json.Id),i=yield n.select(...e)();return v(Ft(it(i)).configureFrom(this),i)}))}assign(e,t){this.data.parentUrl=e.data.url,this.data.url=h(this.data.parentUrl,t||""),this.configureFrom(e)}getCanvasContent1(){return JSON.stringify(this.getControls())}getLayoutWebpartsContent(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)}setControls(e){if(this.sections=[],e&&e.length){for(let t=0;t<e.length;t++)switch(T(e[t],"controlType")?e[t].controlType:0){case 0:T(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new Kr(e[t]));break;case 3:{const r=new Yr(e[t]);this.mergePartToTree(r,r.data.position);break}case 4:{const r=e[t],n=new Jr(r.innerHTML,r);this.mergePartToTree(n,n.data.position);break}}Ar(this.sections)}}getControls(){Ar(this.sections);const e=[];return this.sections.forEach((t=>{t.columns.forEach((r=>{r.controls.length<1?e.push({displayMode:r.data.displayMode,emphasis:this.getEmphasisObj(t.emphasis),position:r.data.position}):r.controls.forEach((r=>{r.data.emphasis=this.getEmphasisObj(t.emphasis),e.push(r.data)}))}))})),e.push(this._pageSettings),e}getEmphasisObj(e){return e<1||e>3?{}:{zoneEmphasis:e}}promoteNewsImpl(e){return k(this,void 0,void 0,(function*(){if(null===this.json.Id)throw Error("The id for this page is null.");return S(this.json.VersionInfo.LastVersionCreatedBy)&&new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3&&(yield this.save(!0)),yield We(Wr(this,`_api/sitepages/pages(${this.json.Id})/${e}`),Fe(Be("SP.Publishing.SitePage")))}))}mergePartToTree(e,t){var r,n,i;let s=null,o=12,a=0,l=0,c=1;t&&(T(t,"zoneIndex")&&(l=t.zoneIndex),T(t,"sectionIndex")&&(a=t.sectionIndex),T(t,"sectionFactor")&&(o=t.sectionFactor),T(t,"layoutIndex")&&(c=t.layoutIndex));const u=null!==(i=null===(n=null===(r=e.data)||void 0===r?void 0:r.emphasis)||void 0===n?void 0:n.zoneEmphasis)&&void 0!==i?i:0,d=this.getOrCreateSection(l,c,u),h=d.columns.filter((e=>e.order===a));s=h.length<1?d.addColumn(o,c):h[0],e.column=s,s.addControl(e)}mergeColumnToTree(e){var t,r;const n=T(e.data,"position")&&T(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,i=T(e.data,"position")&&T(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,s=this.getOrCreateSection(n,i,(null===(r=null===(t=e.data)||void 0===t?void 0:t.emphasis)||void 0===r?void 0:r.zoneEmphasis)||0);e.section=s,s.columns.push(e)}getOrCreateSection(e,t,r){let n=null;const i=this.sections.filter((r=>r.order===e&&r.layoutIndex===t));return i.length<1?(n=2===t?this.addVerticalSection():this.addSection(),n.order=e,n.emphasis=r):n=i[0],n}}$([ke("csp.load")],Hr.prototype,"load",null),$([ke("csp.save")],Hr.prototype,"save",null),$([ke("csp.discardPageCheckout")],Hr.prototype,"discardPageCheckout",null),$([ke("csp.promoteToNews")],Hr.prototype,"promoteToNews",null),$([ke("csp.copy")],Hr.prototype,"copy",null),$([ke("csp.getItem")],Hr.prototype,"getItem",null);const Vr=(e,t,r,n=!1,i=[],s=!1)=>de(Hr)(e,t,r,n,i,s),Gr=e=>k(void 0,void 0,void 0,(function*(){const t=yield e.getItem();return Vr($e(e.toUrl()),"",{Id:t.Id},!0).configureFrom(e).load()})),zr=(e,t,r,n="Article",i=0)=>k(void 0,void 0,void 0,(function*(){t=t.replace(/\.aspx$/i,"");const s=yield We(Wr(e,"_api/sitepages/pages"),Fe(Object.assign(Be("SP.Publishing.SitePage"),{PageLayoutType:n,PromotedState:i}))),o=Vr(e,"",s);return o.title=t,yield o.save(!1),o.title=r,o}));class Qr{constructor(e,t,r,n=[],i=0){this.page=e,this.columns=n,this._emphasis=i,this._memId=g(),this._order=t,this._layoutIndex=r}get order(){return this._order}set order(e){this._order=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e}get layoutIndex(){return this._layoutIndex}set layoutIndex(e){this._layoutIndex=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e}get defaultColumn(){return this.columns.length<1&&this.addColumn(12),this.columns[0]}addColumn(e,t=this.layoutIndex){const r=new Kr;return r.section=this,r.data.position.zoneIndex=this.order,r.data.position.layoutIndex=t,r.data.position.sectionFactor=e,r.order=kr(this.columns),this.columns.push(r),r}addControl(e){return this.defaultColumn.addControl(e),this}get emphasis(){return this._emphasis}set emphasis(e){this._emphasis=e}remove(){this.page.sections=this.page.sections.filter((e=>e._memId!==this._memId)),Ar(this.page.sections)}}class Kr{constructor(e=JSON.parse(JSON.stringify(Kr.Default)),t=[]){this.json=e,this.controls=t,this._section=null,this._memId=g()}get data(){return this.json}get section(){return this._section}set section(e){this._section=e}get order(){return this.data.position.sectionIndex}set order(e){this.data.position.sectionIndex=e;for(let t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e}get factor(){return this.data.position.sectionFactor}set factor(e){this.data.position.sectionFactor=e}addControl(e){return e.column=this,this.controls.push(e),this}getControl(e){return this.controls[e]}remove(){this.section.columns=this.section.columns.filter((e=>e._memId!==this._memId)),Ar(this.section.columns)}}Kr.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class Xr{constructor(e){this.json=e}get id(){return this.json.id}get data(){return this.json}get column(){return this._column}set column(e){this._column=e,this.onColumnChange(this._column)}remove(){this.column.controls=this.column.controls.filter((e=>e.id!==this.id)),Ar(this.column.controls)}setData(e){this.json=e}}class Jr extends Xr{constructor(e,t=JSON.parse(JSON.stringify(Jr.Default))){S(t.id)&&(t.id=g(),t.anchorComponentId=t.id),super(t),this.text=e}get text(){return this.data.innerHTML}set text(e){this.data.innerHTML=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=kr(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex}}Jr.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class Yr extends Xr{constructor(e=JSON.parse(JSON.stringify(Yr.Default))){super(e)}static fromComponentDef(e){const t=new Yr;return t.import(e),t}get title(){return this.data.webPartData.title}set title(e){this.data.webPartData.title=e}get description(){return this.data.webPartData.description}set description(e){this.data.webPartData.description=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}get height(){return this.data.reservedHeight}set height(e){this.data.reservedHeight=e}get width(){return this.data.reservedWidth}set width(e){this.data.reservedWidth=e}get dataVersion(){return this.data.webPartData.dataVersion}set dataVersion(e){this.data.webPartData.dataVersion=e}setProperties(e){return this.data.webPartData.properties=v(this.data.webPartData.properties,e),this}getProperties(){return this.data.webPartData.properties}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=kr(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex,this.data.position.layoutIndex=e.data.position.layoutIndex}import(e){const t=g(),r=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),n=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:n.description.default,id:r,instanceId:t,properties:n.properties,title:n.title.default},webPartId:r}))}}Yr.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},vt.prototype.getClientsideWebParts=function(){return this.clone(Ye,"GetClientSideWebParts")()},vt.prototype.addClientsidePage=function(e,t=e.replace(/\.[^/.]+$/,""),r,n){return zr(this,e,t,r,n)},vt.prototype.loadClientsidePage=function(e){return Gr(this.getFileByServerRelativePath(e))};let Zr=class extends Je{getByName(e){return ke.configure(rn(this).concat(`('${pt(e)}')`),"fs.getByName")}add(e){return k(this,void 0,void 0,(function*(){return{data:yield We(this.clone(en,`add('${pt(e)}')`)),folder:this.getByName(e)}}))}addUsingPath(e,t=!1){return k(this,void 0,void 0,(function*(){return{data:yield We(this.clone(en,`addUsingPath(DecodedUrl='${pt(e)}',overwrite=${t})`)),folder:rn($e(this.toUrl()),`_api/web/getFolderByServerRelativePath(decodedUrl='${pt(e)}')`)}}))}};$([ke("fs.add")],Zr.prototype,"add",null),$([ke("fs.addUsingPath")],Zr.prototype,"addUsingPath",null),Zr=$([nt("folders")],Zr);const en=Qe(Zr);class tn extends Ze{constructor(){super(...arguments),this.delete=rt("f"),this.update=this._update("SP.Folder",(e=>({data:e,folder:this})))}get contentTypeOrder(){return ke.configure(Ye(this,"contentTypeOrder"),"f.contentTypeOrder")}get folders(){return en(this)}get listItemAllFields(){return ke.configure(et(this,"listItemAllFields"),"f.listItemAllFields")}get parentFolder(){return ke.configure(rn(this,"parentFolder"),"f.parentFolder")}get properties(){return ke.configure(et(this,"properties"),"f.properties")}get serverRelativeUrl(){return ke.configure(Xe(this,"serverRelativeUrl"),"f.serverRelativeUrl")}get uniqueContentTypeOrder(){return ke.configure(Ye(this,"uniqueContentTypeOrder"),"f.uniqueContentTypeOrder")}recycle(){return We(this.clone(rn,"recycle"))}getItem(...e){return k(this,void 0,void 0,(function*(){const t=yield this.listItemAllFields.select(...e)();return v(Ft(it(t)),t)}))}moveTo(e){return k(this,void 0,void 0,(function*(){const t=yield this.getParentInfos(),r=new URL(t.ParentWeb.Url);yield We(rn(r.origin,"/_api/SP.MoveCopyUtil.MoveFolder()"),Fe({destUrl:b(e)?e:h(r.origin,e),srcUrl:h(r.origin,t.Folder.ServerRelativeUrl)}))}))}moveByPath(e,t=!1){return k(this,void 0,void 0,(function*(){const r=yield this.getParentInfos(),n=new URL(r.ParentWeb.Url);yield We(rn(n.origin,"/_api/SP.MoveCopyUtil.MoveFolderByPath()"),Fe({destPath:St(b(e)?e:h(n.origin,e)),options:{KeepBoth:t,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:St(h(n.origin,r.Folder.ServerRelativeUrl))}))}))}copyTo(e){return k(this,void 0,void 0,(function*(){const t=yield this.getParentInfos(),r=new URL(t.ParentWeb.Url);yield We(rn(r.origin,"/_api/SP.MoveCopyUtil.CopyFolder()"),Fe({destUrl:b(e)?e:h(r.origin,e),srcUrl:h(r.origin,t.Folder.ServerRelativeUrl)}))}))}copyByPath(e,t=!1){return k(this,void 0,void 0,(function*(){const r=yield this.getParentInfos(),n=new URL(r.ParentWeb.Url);yield We(rn(n.origin,"/_api/SP.MoveCopyUtil.CopyFolderByPath()"),Fe({destPath:St(b(e)?e:h(n.origin,e)),options:{KeepBoth:t,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:St(h(n.origin,r.Folder.ServerRelativeUrl))}))}))}deleteWithParams(e){return k(this,void 0,void 0,(function*(){return We(this.clone(rn,"DeleteWithParameters"),Fe({parameters:e}))}))}addSubFolderUsingPath(e){return k(this,void 0,void 0,(function*(){return yield We(this.clone(rn,"AddSubFolderUsingPath"),Fe({leafPath:St(e)})),this.folders.getByName(e)}))}getParentInfos(){return k(this,void 0,void 0,(function*(){const e=yield this.select("ServerRelativeUrl","ListItemAllFields/ParentList/Id","ListItemAllFields/ParentList/RootFolder/UniqueId","ListItemAllFields/ParentList/RootFolder/ServerRelativeUrl","ListItemAllFields/ParentList/RootFolder/ServerRelativePath","ListItemAllFields/ParentList/ParentWeb/Id","ListItemAllFields/ParentList/ParentWeb/Url","ListItemAllFields/ParentList/ParentWeb/ServerRelativeUrl","ListItemAllFields/ParentList/ParentWeb/ServerRelativePath").expand("ListItemAllFields/ParentList","ListItemAllFields/ParentList/RootFolder","ListItemAllFields/ParentList/ParentWeb")();return{Folder:{ServerRelativeUrl:e.ServerRelativeUrl},ParentList:{Id:e.ListItemAllFields.ParentList.Id,RootFolderServerRelativePath:e.ListItemAllFields.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ListItemAllFields.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ListItemAllFields.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ListItemAllFields.ParentList.ParentWeb.Id,ServerRelativePath:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ListItemAllFields.ParentList.ParentWeb.Url}}}))}getShareable(){return k(this,void 0,void 0,(function*(){const e=yield this.clone(et,"listItemAllFields",!1).select("odata.id")();let t=Ft(it(e));return this.hasBatch&&(t=t.inBatch(this.batch)),t}))}}$([ke("f.recycle")],tn.prototype,"recycle",null),$([ke("f.getItem")],tn.prototype,"getItem",null),$([ke("f.moveTo")],tn.prototype,"moveTo",null),$([ke("f.moveByPath")],tn.prototype,"moveByPath",null),$([ke("f.copyTo")],tn.prototype,"copyTo",null),$([ke("f.copyByPath")],tn.prototype,"copyByPath",null),$([ke("f.del-params")],tn.prototype,"deleteWithParams",null),$([ke("f.getShareable")],tn.prototype,"getShareable",null);const rn=Qe(tn);Y(Tt,"rootFolder",rn,"rootFolder"),Tt.prototype.getDefaultColumnValues=function(){return k(this,void 0,void 0,(function*(){const e=yield this.rootFolder.select("ServerRelativePath")(),t=yield this.select("ParentWeb/Url").expand("ParentWeb")(),r=h("/",e.ServerRelativePath.DecodedUrl,"Forms/client_LocationBasedDefaults.html"),n=h(t.ParentWeb.Url,"_api/web",`getFileByServerRelativePath(decodedUrl='${pt(r)}')`);let i="";try{i=yield rn(n,"$value").usingParser(new ge)(Le({binaryStringResponseBody:"true"}))}catch(e){if(e&&e.status&&404===e.status)return[];throw e}const s=i.match(/<a.*?<\/a>/gi);return(null===s?[]:s.map((e=>e.trim()))).reduce(((e,t)=>{const r=/<a href="(.*?)">/gi.exec(t);if(r.length<1)return o.write(`Could not parse default column value from '${t}'`,2),null;const n=t.match(/<DefaultValue.*?<\/DefaultValue>/gi);return(null===n?[]:n.map((e=>e.trim()))).map((t=>{const n=/<DefaultValue FieldName="(.*?)">(.*?)<\/DefaultValue>/gi.exec(t);n.length<1?o.write(`Could not parse default column value from '${t}'`,2):e.push({name:n[1],path:decodeURIComponent(r[1]),value:n[2]})})),e}),[]).filter((e=>null!==e))}))},Tt.prototype.setDefaultColumnValues=function(e){return k(this,void 0,void 0,(function*(){const t=yield Ye(this,"fields").select("InternalName","TypeAsString").filter("Hidden ne true")(),r=`<MetadataDefaults>${e.map((e=>{const r=t.findIndex((t=>t.InternalName===e.name));if(r<0)throw Error(`Field '${e.name}' does not exist in the list. Please check the internal field name. Failed to set defaults.`);const n=t[r];let i="";switch(n.TypeAsString){case"Boolean":case"Currency":case"Text":case"DateTime":case"Number":case"Choice":case"User":if(m(e.value))throw Error(`The type '${n.TypeAsString}' does not support multiple values.`);i=`${e.value}`;break;case"MultiChoice":i=m(e.value)?e.value.map((e=>`${e}`)).join(";"):`${e.value}`;break;case"UserMulti":i=m(e.value)?e.value.map((e=>`${e}`)).join(";#"):`${e.value}`;break;case"Taxonomy":case"TaxonomyFieldType":if(m(e.value))throw Error(`The type '${n.TypeAsString}' does not support multiple values.`);i=`${e.value.wssId};#${e.value.termName}|${e.value.termId}`;break;case"TaxonomyMulti":case"TaxonomyFieldTypeMulti":m(e.value)&&(i=e.value.map((e=>`${e.wssId};#${e.termName}|${e.termId}`)).join(";#")),i=`${e.value.wssId};#${e.value.termName}|${e.value.termId}`}return`<a href="${e.path.replace(/ /gi,"%20")}"><DefaultValue FieldName="${e.name}">${i}</DefaultValue></a>`})).join("")}</MetadataDefaults>`,n=yield this.rootFolder.select("ServerRelativePath")(),i=yield this.select("ParentWeb/Url").expand("ParentWeb")(),s=h("/",n.ServerRelativePath.DecodedUrl,"Forms"),o=h(i.ParentWeb.Url,"_api/web",`getFolderByServerRelativePath(decodedUrl='${pt(s)}')`,"files");yield We(rn(o,"add(overwrite=true,url='client_LocationBasedDefaults.html')"),{body:r}),(yield this.eventReceivers.filter("ReceiverName eq 'LocationBasedMetadataDefaultsReceiver ItemAdded'").select("ReceiverId")()).length<1&&(yield We(wt(this.eventReceivers,"add"),Fe({eventReceiverCreationInformation:{EventType:10001,ReceiverAssembly:"Microsoft.Office.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c",ReceiverClass:"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver",ReceiverName:"LocationBasedMetadataDefaultsReceiver ItemAdded",SequenceNumber:1e3,Synchronization:1}})))}))},tn.prototype.getDefaultColumnValues=function(){return k(this,void 0,void 0,(function*(){const e=yield rn(this,"Properties").select("vti_x005f_listname")(),{ServerRelativePath:t}=yield this.select("ServerRelativePath")(),r=bt($e(it(e))).lists.getById(e.vti_x005f_listname);return(yield r.getDefaultColumnValues()).filter((e=>e.path.toLowerCase()===t.DecodedUrl.toLowerCase()))}))},tn.prototype.setDefaultColumnValues=function(e,t=!0){return k(this,void 0,void 0,(function*(){const r=yield rn(this,"Properties").select("vti_x005f_listname")(),n=bt($e(it(r))).lists.getById(r.vti_x005f_listname),i=(yield this.select("ServerRelativePath")()).ServerRelativePath.DecodedUrl,s=yield n.getDefaultColumnValues(),o=t?s:s.filter((e=>e.path!==i));e.forEach((e=>{const t=o.find((t=>t.name===e.name&&t.path===i));t?t.value=e.value:o.push({name:e.name,path:i,value:e.value})})),yield n.setDefaultColumnValues(o)}))},tn.prototype.clearDefaultColumnValues=function(){return k(this,void 0,void 0,(function*(){yield this.setDefaultColumnValues([],!1)}))};let nn=class extends Je{addAvailableContentType(e){return k(this,void 0,void 0,(function*(){const t=yield We(this.clone(sn,"addAvailableContentType"),Fe({contentTypeId:e}));return{contentType:this.getById(t.id),data:t}}))}getById(e){return ke.configure(an(this).concat(`('${e}')`),"cts.getById")}add(e,t,r="",n="Custom Content Types",i={}){return k(this,void 0,void 0,(function*(){const s=Fe(Object.assign(Be("SP.ContentType"),{Description:r,Group:n,Id:{StringValue:e},Name:t},i)),o=yield We(this,s);return{contentType:this.getById(o.id),data:o}}))}};$([ke("cts.addAvailableContentType")],nn.prototype,"addAvailableContentType",null),$([ke("cts.add")],nn.prototype,"add",null),nn=$([nt("contenttypes")],nn);const sn=Qe(nn);class on extends Ze{constructor(){super(...arguments),this.delete=tt("ct")}get fieldLinks(){return ke.configure(cn(this),"ct.fieldLinks")}get fields(){return ke.configure(Ye(this,"fields"),"ct.fields")}get parent(){return ke.configure(an(this,"parent"),"ct.parent")}get workflowAssociations(){return ke.configure(Ye(this,"workflowAssociations"),"ct.workflowAssociations")}}const an=Qe(on);let ln=class extends Je{getById(e){return ke.configure(un(this).concat(`(guid'${e}')`),"fls.getById")}};ln=$([nt("fieldlinks")],ln);const cn=Qe(ln),un=Qe(class extends Ze{});Y(vt,"contentTypes",sn),Y(Dt,"contentType",an,"ContentType"),Y(Tt,"contentTypes",sn);let dn=class extends Je{add(e,t=!1){return k(this,void 0,void 0,(function*(){return{data:yield We(this.clone(hn,"add"),Fe({featdefScope:0,featureId:e,force:t})),feature:this.getById(e)}}))}getById(e){const t=gn(this);return t.concat(`('${e}')`),ke.configure(t,"fes.getById")}remove(e,t=!1){return We(this.clone(hn,"remove"),Fe({featureId:e,force:t}))}};$([ke("fes.add")],dn.prototype,"add",null),$([ke("fes.remove")],dn.prototype,"remove",null),dn=$([nt("features")],dn);const hn=Qe(dn);class pn extends Ze{deactivate(e=!1){return k(this,void 0,void 0,(function*(){const t=this.addBatchDependency(),r=yield gn(this).select("DefinitionId")(),n=this.getParent(hn,this.parentUrl,"",this.batch).remove(r.DefinitionId,e);return t(),n}))}}$([ke("fe.deactivate")],pn.prototype,"deactivate",null);const gn=Qe(pn);Y(gt,"features",hn),Y(vt,"features",hn);let yn=class extends Je{createFieldAsXml(e){return k(this,void 0,void 0,(function*(){"string"==typeof e&&(e={SchemaXml:e});const t=Fe({parameters:v(Be("SP.XmlSchemaFieldCreationInformation"),e)}),r=yield We(this.clone(fn,"createfieldasxml"),t);return{data:r,field:this.getById(r.Id)}}))}getById(e){return ke.configure(vn(this).concat(`('${e}')`),"fs.getById")}getByTitle(e){return ke.configure(vn(this,`getByTitle('${e}')`),"fs.getByTitle")}getByInternalNameOrTitle(e){return ke.configure(vn(this,`getByInternalNameOrTitle('${e}')`),"fs.getByInternalNameOrTitle")}add(e,t,r){return k(this,void 0,void 0,(function*(){const n=Fe(Object.assign(Be(t),{Title:e},r));ke.isTagged(this)||ke.configure(this,"fs.add");const i=yield We(this.clone(fn,null),n);return{data:i,field:this.getById(i.Id)}}))}addText(e,t=255,r){const n={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",v(n,r))}addCalculated(e,t,r,n=bn.Text,i){const s={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:n};return this.add(e,"SP.FieldCalculated",v(s,i))}addDateTime(e,t=Sn.DateOnly,r=Tn.Gregorian,n=Pn.Unspecified,i){const s={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:n};return this.add(e,"SP.FieldDateTime",v(s,i))}addNumber(e,t,r,n){let i={FieldTypeKind:9};return void 0!==t&&(i=v({MinimumValue:t},i)),void 0!==r&&(i=v({MaximumValue:r},i)),this.add(e,"SP.FieldNumber",v(i,n))}addCurrency(e,t,r,n=1033,i){let s={CurrencyLocaleId:n,FieldTypeKind:10};return void 0!==t&&(s=v({MinimumValue:t},s)),void 0!==r&&(s=v({MaximumValue:r},s)),this.add(e,"SP.FieldCurrency",v(s,i))}addMultilineText(e,t=6,r=!0,n=!1,i=!1,s=!0,o){const a={AllowHyperlink:s,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:n,RichText:r};return this.add(e,"SP.FieldMultiLineText",v(a,o))}addUrl(e,t=wn.Hyperlink,r){const n={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",v(n,r))}addUser(e,t,r){const n={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",v(n,r))}addLookup(e,t,r,n){return k(this,void 0,void 0,(function*(){const i=v({FieldTypeKind:7,LookupFieldName:r,LookupListId:t,Title:e},n),s=Fe({parameters:v(Be("SP.FieldCreationInformation"),i)}),o=yield We(this.clone(fn,"addfield"),s);return{data:o,field:this.getById(o.Id)}}))}addChoice(e,t,r=xn.Dropdown,n,i){const s={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:n};return this.add(e,"SP.FieldChoice",v(s,i))}addMultiChoice(e,t,r,n){const i={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",v(i,n))}addBoolean(e,t){return this.add(e,"SP.Field",v({FieldTypeKind:8},t))}addDependentLookupField(e,t,r){return k(this,void 0,void 0,(function*(){const n=`adddependentlookupfield(displayName='${e}', primarylookupfieldid='${t}', showfield='${r}')`,i=yield We(this.clone(fn,n));return{data:i,field:this.getById(i.Id)}}))}addLocation(e,t){return this.add(e,"SP.FieldLocation",v({FieldTypeKind:33},t))}};$([ke("fs.createFieldAsXml")],yn.prototype,"createFieldAsXml",null),$([ke("fs.addText")],yn.prototype,"addText",null),$([ke("fs.addCalculated")],yn.prototype,"addCalculated",null),$([ke("fs.addDateTime")],yn.prototype,"addDateTime",null),$([ke("fs.addNumber")],yn.prototype,"addNumber",null),$([ke("fs.addCurrency")],yn.prototype,"addCurrency",null),$([ke("fs.addMultilineText")],yn.prototype,"addMultilineText",null),$([ke("fs.addUrl")],yn.prototype,"addUrl",null),$([ke("fs.addUser")],yn.prototype,"addUser",null),$([ke("fs.addLookup")],yn.prototype,"addLookup",null),$([ke("fs.addChoice")],yn.prototype,"addChoice",null),$([ke("fs.addMultiChoice")],yn.prototype,"addMultiChoice",null),$([ke("fs.addBoolean")],yn.prototype,"addBoolean",null),$([ke("fs.addDependentLookupField")],yn.prototype,"addDependentLookupField",null),$([ke("fs.addLocation")],yn.prototype,"addLocation",null),yn=$([nt("fields")],yn);const fn=Qe(yn);class mn extends Ze{constructor(){super(...arguments),this.delete=tt("f")}update(e,t){return k(this,void 0,void 0,(function*(){if(null==t){const e=yield vn(this).select("FieldTypeKind").configure({headers:{Accept:"application/json"}})();t=e["odata.type"]}const r=Fe(v(Be(t),e),Le({"X-HTTP-Method":"MERGE"}));return{data:yield We(this,r),field:this}}))}setShowInDisplayForm(e){return We(this.clone(vn,`setshowindisplayform(${e})`))}setShowInEditForm(e){return We(this.clone(vn,`setshowineditform(${e})`))}setShowInNewForm(e){return We(this.clone(vn,`setshowinnewform(${e})`))}}$([ke("f.update")],mn.prototype,"update",null),$([ke("f.setShowInDisplayForm")],mn.prototype,"setShowInDisplayForm",null),$([ke("f.setShowInEditForm")],mn.prototype,"setShowInEditForm",null),$([ke("f.setShowInNewForm")],mn.prototype,"setShowInNewForm",null);const vn=Qe(mn);var bn,Sn,Pn,In,Tn,wn,Cn,xn;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(bn||(bn={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(Sn||(Sn={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(Pn||(Pn={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(In||(In={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(Tn||(Tn={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(wn||(wn={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(Cn||(Cn={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(xn||(xn={})),Y(vt,"fields",fn),Y(vt,"availablefields",fn,"availablefields"),Y(Tt,"fields",fn),Y(tn,"files",vr),Y(Dt,"file",Sr,"file"),Y(Dt,"folder",rn,"folder"),Y(Tt,"rootFolder",rn,"rootFolder"),Y(vt,"folders",en),Y(vt,"rootFolder",rn,"rootFolder"),vt.prototype.getFolderByServerRelativeUrl=function(e){return rn(this,`getFolderByServerRelativeUrl('${pt(e)}')`)},vt.prototype.getFolderByServerRelativePath=function(e){return rn(this,`getFolderByServerRelativePath(decodedUrl='${pt(e)}')`)},vt.prototype.getFolderById=function(e){return rn(this,`getFolderById('${e}')`)};let Rn=class extends Je{getById(e){return ke.configure(Dn(this).concat(`('${e}')`),"fos.getById")}};Rn=$([nt("forms")],Rn);const Un=Qe(Rn),Dn=Qe(class extends Ze{});Y(Tt,"forms",Un,"forms");let Fn=class extends Je{getById(e){return ke.configure($n(this,`GetById?hubSiteId='${e}'`),"hss.getById")}};Fn=$([nt("_api/hubsites")],Fn);const Ln=Qe(Fn);class Bn extends Ze{getSite(){return k(this,void 0,void 0,(function*(){const e=yield this.select("SiteUrl")();return yt(e.SiteUrl)}))}}$([ke("hs.getSite")],Bn.prototype,"getSite",null);const $n=Qe(Bn);gt.prototype.joinHubSite=function(e){return k(this,void 0,void 0,(function*(){yield We(this.clone(yt,`joinHubSite('${e}')`))}))},gt.prototype.registerHubSite=function(){return k(this,void 0,void 0,(function*(){yield We(this.clone(yt,"registerHubSite"))}))},gt.prototype.unRegisterHubSite=function(){return k(this,void 0,void 0,(function*(){yield We(this.clone(yt,"unRegisterHubSite"))}))},vt.prototype.hubSiteData=function(e=!1){return k(this,void 0,void 0,(function*(){const t=yield this.clone(bt,`hubSiteData(${e})`)();return"string"==typeof t?JSON.parse(t):t}))},vt.prototype.syncHubSiteTheme=function(){return We(this.clone(bt,"syncHubSiteTheme"))},Reflect.defineProperty(ht.prototype,"hubSites",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Ln(t).configure(e).setRuntime(r)))}});class kn extends Je{getById(e){return ke.configure(On(this).concat(`(${e})`),"nns.getById")}add(e,t,r=!0){return k(this,void 0,void 0,(function*(){const n=Fe(v(Be("SP.NavigationNode"),{IsVisible:r,Title:e,Url:t})),i=yield We(this.clone(An,null),n);return{data:i,node:this.getById(i.Id)}}))}moveAfter(e,t){const r=Fe({nodeId:e,previousNodeId:t});return We(this.clone(An,"MoveAfter"),r)}}$([ke("nns.add")],kn.prototype,"add",null),$([ke("nns.moveAfter")],kn.prototype,"moveAfter",null);const An=Qe(kn);class _n extends Ze{constructor(){super(...arguments),this.delete=tt("nn")}get children(){return ke.configure(An(this,"children"),"nn.children")}update(e){return k(this,void 0,void 0,(function*(){const t=Fe(v(Be("SP.NavigationNode"),e),Le({"X-HTTP-Method":"MERGE"}));return{data:yield We(this,t),node:this}}))}}$([ke("nn.update")],_n.prototype,"update",null);const On=Qe(_n);let En=class extends Ke{get quicklaunch(){return ke.configure(An(this,"quicklaunch"),"n.quicklaunch")}get topNavigationBar(){return ke.configure(An(this,"topnavigationbar"),"n.topnavigationbar")}};En=$([nt("navigation")],En);const Nn=Qe(En);class Mn extends Ke{constructor(e=null){super("_api/navigation",e)}getMenuState(e=null,t=10,r=null,n=null){return We(qn("MenuState"),Fe({customProperties:n,depth:t,mapProviderName:r,menuNodeKey:e}))}getMenuNodeKey(e,t=null){return We(qn("MenuNodeKey"),Fe({currentUrl:e,mapProviderName:t}))}}$([ke("ns.getMenuState")],Mn.prototype,"getMenuState",null),$([ke("ns.getMenuNodeKey")],Mn.prototype,"getMenuNodeKey",null);const qn=e=>new Mn(e);Y(vt,"navigation",Nn),Reflect.defineProperty(ht.prototype,"navigation",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>qn(t).configure(e).setRuntime(r)))}});class jn extends Ze{constructor(e,t="_api/sp.userprofiles.peoplemanager"){super(e,t),this.clientPeoplePickerQuery=new Gn(e).configureFrom(this),this.profileLoader=new Hn(e).configureFrom(this)}get editProfileLink(){return this.clone(Wn,"EditProfileLink").get()}get isMyPeopleListPublic(){return this.clone(Wn,"IsMyPeopleListPublic").get()}amIFollowedBy(e){const t=this.clone(Wn,"amifollowedby(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}amIFollowing(e){const t=this.clone(Wn,"amifollowing(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}getFollowedTags(e=20){return this.clone(Wn,`getfollowedtags(${e})`).get()}getFollowersFor(e){const t=this.clone(Wn,"getfollowersfor(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}get myFollowers(){return Ye(this,"getmyfollowers")}get myProperties(){return new jn(this,"getmyproperties")}getPeopleFollowedBy(e){const t=this.clone(Wn,"getpeoplefollowedby(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}getPropertiesFor(e){const t=this.clone(Wn,"getpropertiesfor(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}get trendingTags(){const e=this.clone(Wn,null);return e.concat(".gettrendingtags"),e.get()}getUserProfilePropertyFor(e,t){const r=this.clone(Wn,`getuserprofilepropertyfor(accountname=@v, propertyname='${t}')`);return r.query.set("@v",`'${encodeURIComponent(e)}'`),r.get()}hideSuggestion(e){const t=this.clone(Wn,"hidesuggestion(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),We(t)}isFollowing(e,t){const r=this.clone(Wn,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.set("@v",`'${encodeURIComponent(e)}'`),r.query.set("@y",`'${encodeURIComponent(t)}'`),r.get()}setMyProfilePic(e){return new Promise(((t,r)=>{const n=new FileReader;n.onload=e=>k(this,void 0,void 0,(function*(){const n=e.target.result;try{yield We(Wn(this,"setmyprofilepicture"),{body:n}),t()}catch(e){r(e)}})),n.readAsArrayBuffer(e)}))}setSingleValueProfileProperty(e,t,r){return We(this.clone(Wn,"SetSingleValueProfileProperty"),Fe({accountName:e,propertyName:t,propertyValue:r}))}setMultiValuedProfileProperty(e,t,r){return We(this.clone(Wn,"SetMultiValuedProfileProperty"),Fe({accountName:e,propertyName:t,propertyValues:r}))}createPersonalSiteEnqueueBulk(...e){return this.profileLoader.createPersonalSiteEnqueueBulk(e)}get ownerUserProfile(){return this.profileLoader.ownerUserProfile}get userProfile(){return this.profileLoader.userProfile}createPersonalSite(e=!1){return this.profileLoader.createPersonalSite(e)}shareAllSocialData(e){return this.profileLoader.shareAllSocialData(e)}clientPeoplePickerResolveUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)}clientPeoplePickerSearchUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)}}const Wn=Qe(jn);let Hn=class extends Ke{createPersonalSiteEnqueueBulk(e){return We(this.clone(Vn,"createpersonalsiteenqueuebulk",!1),Fe({emailIDs:e}))}get ownerUserProfile(){let e=this.getParent(Vn,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),We(e)}get userProfile(){return We(this.clone(Vn,"getuserprofile"))}createPersonalSite(e=!1){return We(this.clone(Vn,`getuserprofile/createpersonalsiteenque(${e})`))}shareAllSocialData(e){return We(this.clone(Vn,`getuserprofile/shareallsocialdata(${e})`))}};Hn=$([nt("_api/sp.userprofiles.profileloader.getprofileloader")],Hn);const Vn=(e,t)=>new Hn(e,t);let Gn=class extends Ke{clientPeoplePickerResolveUser(e){return k(this,void 0,void 0,(function*(){const t=this.clone(zn,null);t.concat(".clientpeoplepickerresolveuser");const r=yield We(t,this.getBodyFrom(e));return JSON.parse("object"==typeof r?r.ClientPeoplePickerResolveUser:r)}))}clientPeoplePickerSearchUser(e){return k(this,void 0,void 0,(function*(){const t=this.clone(zn,null);t.concat(".clientpeoplepickersearchuser");const r=yield We(t,this.getBodyFrom(e));return JSON.parse("object"==typeof r?r.ClientPeoplePickerSearchUser:r)}))}getBodyFrom(e){return Fe({queryParams:v(Be("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})}};Gn=$([nt("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],Gn);const zn=(e,t)=>new Gn(e,t);var Qn;!function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(Qn||(Qn={})),Reflect.defineProperty(ht.prototype,"profiles",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Wn(t).configure(e).setRuntime(r)))}});let Kn=class extends Ze{get installedLanguages(){return console.warn("Deprecated: RegionalSettings.installedLanguages is deprecated, please use RegionalSettings.getInstalledLanguages"),ke.configure(Ye(this,"installedlanguages"),"rs.installedLanguages")}get timeZone(){return ke.configure(Yn(this),"rs.tz")}get timeZones(){return ke.configure(ei(this),"rs.tzs")}getInstalledLanguages(){return k(this,void 0,void 0,(function*(){return(yield ke.configure(Ye(this,"installedlanguages"),"rs.getInstalledLanguages")()).Items}))}};Kn=$([nt("regionalsettings")],Kn);const Xn=Qe(Kn);let Jn=class extends Ze{utcToLocalTime(e){return k(this,void 0,void 0,(function*(){let t;t="string"==typeof e?e:e.toISOString();const r=yield We(this.clone(Yn,`utctolocaltime('${t}')`));return T(r,"UTCToLocalTime")?r.UTCToLocalTime:r}))}localTimeToUTC(e){return k(this,void 0,void 0,(function*(){let t;t="string"==typeof e?e:d(e,"minute",-1*e.getTimezoneOffset()).toISOString();const r=yield We(this.clone(Yn,`localtimetoutc('${t}')`));return T(r,"LocalTimeToUTC")?r.LocalTimeToUTC:r}))}};$([ke("tz.utcToLocalTime")],Jn.prototype,"utcToLocalTime",null),$([ke("tz.localTimeToUTC")],Jn.prototype,"localTimeToUTC",null),Jn=$([nt("timezone")],Jn);const Yn=Qe(Jn);let Zn=class extends Je{getById(e){return We(this.clone(ei,`GetById(${e})`).usingParser(at(Yn)))}};$([ke("tzs.getById")],Zn.prototype,"getById",null),Zn=$([nt("timezones")],Zn);const ei=Qe(Zn);function ti(e){return function(t){return We(this.clone(Xe,`${e}/getValueForUICulture`),Fe({cultureName:t}))}}Y(vt,"regionalSettings",Xn),vt.prototype.titleResource=ti("titleResource"),vt.prototype.descriptionResource=ti("descriptionResource");let ri=class extends Je{getById(e){return ke.configure(si(this).concat(`('${e}')`),"ucas.getById")}add(e){return k(this,void 0,void 0,(function*(){const t=yield We(this,Fe(v(Be("SP.UserCustomAction"),e)));return{action:this.getById(t.Id),data:t}}))}clear(){return We(this.clone(ni,"clear"))}};$([ke("ucas.add")],ri.prototype,"add",null),$([ke("ucas.clear")],ri.prototype,"clear",null),ri=$([nt("usercustomactions")],ri);const ni=Qe(ri);class ii extends Ze{constructor(){super(...arguments),this.delete=tt("uca"),this.update=this._update("SP.UserCustomAction",(e=>({data:e,action:this})))}}const si=Qe(ii);var oi,ai;!function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(oi||(oi={})),function(e){e[e.Unknown=0]="Unknown",e[e.Site=2]="Site",e[e.Web=3]="Web",e[e.List=4]="List"}(ai||(ai={})),ii.prototype.titleResource=ti("titleResource"),ii.prototype.descriptionResource=ti("descriptionResource"),Tt.prototype.titleResource=ti("titleResource"),Tt.prototype.descriptionResource=ti("descriptionResource"),mn.prototype.titleResource=ti("titleResource"),mn.prototype.descriptionResource=ti("descriptionResource"),on.prototype.titleResource=ti("titleResource"),on.prototype.descriptionResource=ti("descriptionResource");let li=class extends Ke{getRelatedItems(e,t){const r=this.clone(ci,null);return r.concat(".GetRelatedItems"),We(r,Fe({SourceItemID:t,SourceListName:e}))}getPageOneRelatedItems(e,t){const r=this.clone(ci,null);return r.concat(".GetPageOneRelatedItems"),We(r,Fe({SourceItemID:t,SourceListName:e}))}addSingleLink(e,t,r,n,i,s,o=!1){const a=this.clone(ci,null);return a.concat(".AddSingleLink"),We(a,Fe({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:n,TargetWebUrl:s,TryAddReverseLink:o}))}addSingleLinkToUrl(e,t,r,n=!1){const i=this.clone(ci,null);return i.concat(".AddSingleLinkToUrl"),We(i,Fe({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:n}))}addSingleLinkFromUrl(e,t,r,n=!1){const i=this.clone(ci,null);return i.concat(".AddSingleLinkFromUrl"),We(i,Fe({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:n}))}deleteSingleLink(e,t,r,n,i,s,o=!1){const a=this.clone(ci,null);return a.concat(".DeleteSingleLink"),We(a,Fe({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:n,TargetWebUrl:s,TryDeleteReverseLink:o}))}};$([ke("rim.getRelatedItems")],li.prototype,"getRelatedItems",null),$([ke("rim.getPageOneRelatedItems")],li.prototype,"getPageOneRelatedItems",null),$([ke("rim.addSingleLink")],li.prototype,"addSingleLink",null),$([ke("rim.ToUrl")],li.prototype,"addSingleLinkToUrl",null),$([ke("rim.FromUrl")],li.prototype,"addSingleLinkFromUrl",null),$([ke("rim.deleteSingleLink")],li.prototype,"deleteSingleLink",null),li=$([nt("_api/SP.RelatedItemManager")],li);const ci=e=>new li($e("string"==typeof e?e:e.toUrl())),ui=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),di=new Map([]);function hi(e){return e.replace(/^(.)/,(e=>e.toUpperCase()))}function pi(e="",t={}){return new Proxy({query:Object.assign({Querytext:e},t)},{get(e,t,r){const n=t.toString();if("toSearchQuery"===n)return()=>e.query;if(ui.has(n))return(...t)=>{const i=ui.get(n);return e.query[i.length>0?i:hi(n)]=t.length>1?t:t[0],r};const i=di.has(n)?di.get(n):hi(n);return e.query[i]=!0,r}})}const gi=/_api\/search\/postquery$/i;let yi=class extends Ze{execute(e){return k(this,void 0,void 0,(function*(){const t=this.parseQuery(e),r=Fe({request:v(Be("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},t,{HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}))});if(this.data.useCaching){this._forceCaching=!0;const e=`PnPjs.SearchWithCaching(${w(r.body)})`;f(this.data.cachingOptions)?gi.test(this.data.cachingOptions.key)&&(this.data.cachingOptions.key=e):this.data.cachingOptions=new X(e)}const n=yield We(this,r);return new mi(n,this.toUrl(),t)}))}fixArrProp(e){return void 0===e?{results:[]}:{results:m(e)?e:[e]}}parseQuery(e){let t;return t="string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e,t}};$([ke("se.execute")],yi.prototype,"execute",null),yi=$([nt("_api/search/postquery")],yi);const fi=(e,t={},r=B)=>n=>new yi(e).configure(t).setRuntime(r).execute(n);class mi{constructor(e,t,r,n=null,i=null){this._url=t,this._query=r,this._raw=n,this._primary=i,this._url=this._url.replace(gi,""),this._raw=e.postquery?e.postquery:e}get ElapsedTime(){var e;return(null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.ElapsedTime)||0}get RowCount(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.RowCount)||0}get TotalRows(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.TotalRows)||0}get TotalRowsIncludingDuplicates(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.TotalRowsIncludingDuplicates)||0}get RawSearchResults(){return this._raw}get PrimarySearchResults(){var e,t,r,n;return null===this._primary&&(this._primary=this.formatSearchResults((null===(n=null===(r=null===(t=null===(e=this._raw)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.Table)||void 0===n?void 0:n.Rows)||null)),this._primary}getPage(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);const r=void 0!==t?t:T(this._query,"RowLimit")?this._query.RowLimit:10,n=v(this._query,{RowLimit:r,StartRow:r*(e-1)});return n.StartRow>this.TotalRows?Promise.resolve(null):fi(this._url)(n)}formatSearchResults(e){const t=new Array;if(void 0===e||null==e)return[];const r=e.results?e.results:e;for(const e of r){const r=e.Cells.results?e.Cells.results:e.Cells;t.push(r.reduce(((e,t)=>(Reflect.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e)),{}))}return t}}let vi=class extends Ze{execute(e){return k(this,void 0,void 0,(function*(){this.mapQueryToQueryString(e);const t=yield this.get(),r=T(t,"suggest")?e=>t.suggest[e].results:e=>t[e];return{PeopleNames:r("PeopleNames"),PersonalResults:r("PersonalResults"),Queries:r("Queries")}}))}mapQueryToQueryString(e){this.query.set("querytext",`'${e.querytext}'`);const t=(e=>t=>r=>{T(e,t)&&this.query.set(r,e[t].toString())})(e);t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")}};$([ke("su.execute")],vi.prototype,"execute",null),vi=$([nt("_api/search/suggest")],vi);const bi=(e,t={},r=B)=>n=>new vi(e).configure(t).setRuntime(r).execute(n);var Si,Pi,Ii;!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(Si||(Si={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(Pi||(Pi={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(Ii||(Ii={}));class Ti{}Ti.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",Ti.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",Ti.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",Ti.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",Ti.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",Ti.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",Ti.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",Ti.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",Ti.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",Ti.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",Ti.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",Ti.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",Ti.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",Ti.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",Ti.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",ht.prototype.search=function(e){return this.childConfigHook((({options:t,baseUrl:r,runtime:n})=>fi(r,t,n)(e)))},ht.prototype.searchWithCaching=function(e,t){return this.childConfigHook((({options:r,baseUrl:n,runtime:i})=>new yi(n).configure(r).setRuntime(i).usingCaching(t).execute(e)))},ht.prototype.searchSuggest=function(e){return this.childConfigHook((({options:t,baseUrl:r,runtime:n})=>bi(r,t,n)("string"==typeof e?{querytext:e}:e)))};let wi=class extends Je{getById(e){return ke.configure(xi(this,`getById(${e})`),"sus.getById")}getByEmail(e){return ke.configure(xi(this,`getByEmail('${e}')`),"sus.getByEmail")}getByLoginName(e){return ke.configure(xi(this).concat(`('!@v::${encodeURIComponent(e)}')`),"sus.getByLoginName")}removeById(e){return We(this.clone(Ci,`removeById(${e})`))}removeByLoginName(e){const t=this.clone(Ci,"removeByLoginName(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),We(t)}add(e){return k(this,void 0,void 0,(function*(){return yield We(this,Fe(v(Be("SP.User"),{LoginName:e}))),this.getByLoginName(e)}))}};$([ke("sus.remId")],wi.prototype,"removeById",null),$([ke("sus.remLoginName")],wi.prototype,"removeByLoginName",null),$([ke("sus.add")],wi.prototype,"add",null),wi=$([nt("siteusers")],wi);const Ci=Qe(wi),xi=Qe(class extends Ze{constructor(){super(...arguments),this.delete=tt("su"),this.update=this._update("SP.User",(e=>({data:e,user:this})))}get groups(){return ke.configure(Ui(this,"groups"),"su.groups")}});let Ri=class extends Je{getById(e){return ke.configure(Fi(this).concat(`(${e})`),"sgs.getById")}add(e){return k(this,void 0,void 0,(function*(){const t=Fe(v(Be("SP.Group"),e)),r=yield We(ke.configure(this,"sgs.add"),t);return{data:r,group:this.getById(r.Id)}}))}getByName(e){return ke.configure(Fi(this,`getByName('${e}')`),"sgs.getByName")}removeById(e){return We(this.clone(Ui,`removeById('${e}')`))}removeByLoginName(e){return We(this.clone(Ui,`removeByLoginName('${e}')`))}};$([ke("sgs.removeById")],Ri.prototype,"removeById",null),$([ke("sgs.removeByLoginName")],Ri.prototype,"removeByLoginName",null),Ri=$([nt("sitegroups")],Ri);const Ui=Qe(Ri);class Di extends Ze{constructor(){super(...arguments),this.update=this._update("SP.Group",((e,t)=>({data:e,group:T(t,"Title")?this.getParent(Fi,this.parentUrl,`getByName('${t.Title}')`):Fi(this)})))}get users(){return ke.configure(Ci(this,"users"),"sg.users")}setUserAsOwner(e){return We(this.clone(Fi,`SetUserAsOwner(${e})`))}}$([ke("sg.setUserAsOwner")],Di.prototype,"setUserAsOwner",null);const Fi=Qe(Di);let Li=class extends Je{getById(e){return $i(this).concat(`(${e})`)}add(e,t){return k(this,void 0,void 0,(function*(){yield We(this.clone(Bi,`addroleassignment(principalid=${e}, roledefid=${t})`))}))}remove(e,t){return k(this,void 0,void 0,(function*(){yield We(this.clone(Bi,`removeroleassignment(principalid=${e}, roledefid=${t})`))}))}};Li=$([nt("roleassignments")],Li);const Bi=Qe(Li),$i=Qe(class extends Ze{constructor(){super(...arguments),this.delete=tt("ra")}get groups(){return ke.configure(Ui(this,"groups"),"ra.groups")}get bindings(){return Ye(this,"roledefinitionbindings")}});let ki=class extends Je{getById(e){return _i(this,`getById(${e})`)}getByName(e){return _i(this,`getbyname('${e}')`)}getByType(e){return _i(this,`getbytype(${e})`)}add(e,t,r,n){return k(this,void 0,void 0,(function*(){const i=Fe({BasePermissions:{High:n.High.toString(),Low:n.Low.toString()},Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}}),s=yield We(this,i);return{data:s,definition:this.getById(s.Id)}}))}};ki=$([nt("roledefinitions")],ki);const Ai=Qe(ki),_i=Qe(class extends Ze{constructor(){super(...arguments),this.delete=tt("rd")}update(e){return k(this,void 0,void 0,(function*(){const t=["BasePermissions"];if(void 0!==T(e,t[0])){e[t[0]]=v(Be(`SP.${t[0]}`),e[t[0]]);const r=e[t[0]];r.High=r.High.toString(),r.Low=r.Low.toString()}const r=Fe(v(Be("SP.RoleDefinition"),e),Le({"X-HTTP-Method":"MERGE"})),n=yield We(this,r);let i=this;return T(e,"Name")&&(i=this.getParent(Ai,this.parentUrl,"").getByName(e.Name)),{data:n,definition:i}}))}});var Oi,Ei,Ni,Mi,qi,ji,Wi;function Hi(e){return k(this,void 0,void 0,(function*(){const t=this.clone(et,"getUserEffectivePermissions(@user)");t.query.set("@user",`'${encodeURIComponent(e)}'`);const r=yield t.get();return T(r,"GetUserEffectivePermissions")?r.GetUserEffectivePermissions:r}))}function Vi(){return k(this,void 0,void 0,(function*(){return this.clone(Xe,"EffectiveBasePermissions").get().then((e=>T(e,"EffectiveBasePermissions")?e.EffectiveBasePermissions:e))}))}function Gi(e=!1,t=!1){return k(this,void 0,void 0,(function*(){yield We(this.clone(Xe,`breakroleinheritance(copyroleassignments=${e}, clearsubscopes=${t})`))}))}function zi(){return k(this,void 0,void 0,(function*(){yield We(this.clone(Xe,"resetroleinheritance"))}))}function Qi(e,t){return k(this,void 0,void 0,(function*(){const r=yield Hi.call(this,e);return this.hasPermissions(r,t)}))}function Ki(e){return k(this,void 0,void 0,(function*(){const t=yield Vi.call(this);return this.hasPermissions(t,e)}))}function Xi(e,t){if(!t)return!0;if(t===Oi.FullMask)return 32767==(32767&e.High)&&65535===e.Low;let r=1;return(t-=1)>=0&&t<32?(r<<=t,0!=(e.Low&r)):t>=32&&t<64&&(r<<=t-32,0!=(e.High&r))}function Ji(e,t,r=!1){return k(this,void 0,void 0,(function*(){if(r)return os(e,t);t=v(t,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0);const n=yield function(e,t){return k(this,void 0,void 0,(function*(){if(null==t){const t=e===Ei.Edit?Wi.Contributor:Wi.Reader,r=yield Ai("_api/web").select("Id").top(1).filter(`RoleTypeKind eq ${t}`)();if(r.length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return`role: ${r[0].Id}`}switch(t){case Wi.Contributor:return`group: ${(yield bt("_api/web","associatedmembergroup").select("Id")()).Id}`;case Wi.Reader:case Wi.Guest:return`group: ${(yield bt("_api/web","associatedvisitorgroup").select("Id")()).Id}`;default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}}))}(t.role,t.group);Array.isArray(t.loginNames)||(t.loginNames=[t.loginNames]);let i={peoplePickerInput:I(t.loginNames.map((e=>({Key:e})))),roleValue:n,url:t.url};return void 0!==t.emailData&&null!==t.emailData&&(i=v(i,{emailBody:t.emailData.body,emailSubject:void 0!==t.emailData.subject?t.emailData.subject:"Shared with you.",sendEmail:!0})),os(e,i)}))}function Yi(e,t=null){const r=null!==t?t.toISOString():null,n=ke.configure(this.clone(et,"shareLink"),"sh.getShareLink");return We(n,Fe({request:{createLink:!0,emailData:null,settings:{expiration:r,linkKind:e}}}))}function Zi(e){const t=ke.configure(this.clone(et,"checkPermissions"),"sh.checkPermissions");return We(t,Fe({recipients:e}))}function es(e=null,t=[]){const r=ke.configure(this.clone(et,"getSharingInformation"),"sh.getSharingInformation");return We(r.expand(...t),Fe({request:e}))}function ts(e=!0){const t=ke.configure(this.clone(et,"getObjectSharingSettings"),"sh.getObjectSharingSettings");return We(t,Fe({useSimplifiedRoles:e}))}function rs(){return We(ke.configure(this.clone(et,"unshareObject"),"sh.unshareObject"))}function ns(e){return We(ke.configure(this.clone(et,"deleteLinkByKind"),"sh.deleteLinkByKind"),Fe({linkKind:e}))}function is(e,t=ut){return We(ke.configure(this.clone(et,"unshareLink"),"sh.unshareLink"),Fe({linkKind:e,shareId:t}))}function ss(e,t,r,n=!1,i=!1,s){return k(this,void 0,void 0,(function*(){Array.isArray(t)||(t=[t]);const o=I(t.map((e=>({Key:e})))),a=r===Ei.Edit?Wi.Contributor:Wi.Reader,l=Ye("_api/web","roledefinitions"),c=yield l.select("Id").filter(`RoleTypeKind eq ${a}`).get();if(!Array.isArray(c)||c.length<1)throw Error(`Could not locate a role defintion with RoleTypeKind ${a}`);let u={includeAnonymousLinkInEmail:n,peoplePickerInput:o,propagateAcl:i,roleValue:`role:${c[0].Id}`,useSimplifiedRoles:!0};return void 0!==s&&(u=v(u,{emailBody:s.body,emailSubject:void 0!==s.subject?s.subject:"",sendEmail:!0})),We(ke.configure(e.clone(et,"shareObject"),"sh.shareWith"),Fe(u))}))}function os(e,t){const r=ke.configure(bt($e(e.toUrl()),"/_api/SP.Web.ShareObject"),"sh.sendShareObjectRequest");return We(r.expand("UsersWithAccessRequests","GroupsSharedWith"),Fe(t))}!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(Oi||(Oi={})),Y(Dt,"roleAssignments",Bi),Y(Dt,"firstUniqueAncestorSecurableObject",et),Dt.prototype.getUserEffectivePermissions=Hi,Dt.prototype.getCurrentUserEffectivePermissions=Vi,Dt.prototype.breakRoleInheritance=Gi,Dt.prototype.resetRoleInheritance=zi,Dt.prototype.userHasPermissions=Qi,Dt.prototype.currentUserHasPermissions=Ki,Dt.prototype.hasPermissions=Xi,Y(Tt,"roleAssignments",Bi),Y(Tt,"firstUniqueAncestorSecurableObject",et),Tt.prototype.getUserEffectivePermissions=Hi,Tt.prototype.getCurrentUserEffectivePermissions=Vi,Tt.prototype.breakRoleInheritance=Gi,Tt.prototype.resetRoleInheritance=zi,Tt.prototype.userHasPermissions=Qi,Tt.prototype.currentUserHasPermissions=Ki,Tt.prototype.hasPermissions=Xi,Y(vt,"roleDefinitions",Ai),Y(vt,"roleAssignments",Bi),Y(vt,"firstUniqueAncestorSecurableObject",et),vt.prototype.getUserEffectivePermissions=Hi,vt.prototype.getCurrentUserEffectivePermissions=Vi,vt.prototype.breakRoleInheritance=Gi,vt.prototype.resetRoleInheritance=zi,vt.prototype.userHasPermissions=Qi,vt.prototype.currentUserHasPermissions=Ki,vt.prototype.hasPermissions=Xi,function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(Ei||(Ei={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(Ni||(Ni={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(Mi||(Mi={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(qi||(qi={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(ji||(ji={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(Wi||(Wi={})),br.prototype.shareWith=function(e,t=Ei.View,r=!1,n){return ss(this,e,t,r,!1,n)},br.prototype.getShareLink=Yi,br.prototype.checkSharingPermissions=Zi,br.prototype.getSharingInformation=es,br.prototype.getObjectSharingSettings=ts,br.prototype.unshare=rs,br.prototype.deleteSharingLinkByKind=ns,br.prototype.unshareLink=is,tn.prototype.shareWith=function(e,t=Ei.View,r=!1,n=!1,i){return k(this,void 0,void 0,(function*(){const s=this.addBatchDependency(),o=yield this.getShareable();return s(),o.shareWith(e,t,r,n,i)}))},tn.prototype.getShareLink=function(e,t=null){return k(this,void 0,void 0,(function*(){const r=this.addBatchDependency(),n=yield this.getShareable();return r(),n.getShareLink(e,t)}))},tn.prototype.checkSharingPermissions=function(e){return k(this,void 0,void 0,(function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.checkSharingPermissions(e)}))},tn.prototype.getSharingInformation=function(e,t){return k(this,void 0,void 0,(function*(){const r=this.addBatchDependency(),n=yield this.getShareable();return r(),n.getSharingInformation(e,t)}))},tn.prototype.getObjectSharingSettings=function(e=!0){return k(this,void 0,void 0,(function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.getObjectSharingSettings(e)}))},tn.prototype.unshare=function(){return k(this,void 0,void 0,(function*(){const e=this.addBatchDependency(),t=yield this.getShareable();return e(),t.unshare()}))},tn.prototype.deleteSharingLinkByKind=function(e){return k(this,void 0,void 0,(function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.deleteSharingLinkByKind(e)}))},tn.prototype.unshareLink=function(e,t){return k(this,void 0,void 0,(function*(){const r=this.addBatchDependency(),n=yield this.getShareable();return r(),n.unshareLink(e,t)}))},Dt.prototype.shareWith=function(e,t=Ei.View,r=!1,n){return ss(this,e,t,r,!1,n)},Dt.prototype.getShareLink=Yi,Dt.prototype.checkSharingPermissions=Zi,Dt.prototype.getSharingInformation=es,Dt.prototype.getObjectSharingSettings=ts,Dt.prototype.unshare=rs,Dt.prototype.deleteSharingLinkByKind=ns,Dt.prototype.unshareLink=is,vt.prototype.shareWith=function(e,t=Ei.View,r){return k(this,void 0,void 0,(function*(){const n=this.addBatchDependency(),i=new Ze($e(this.toUrl()),"/_api/web/url"),s=yield i.get();return n(),this.shareObject(h(s,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)}))},vt.prototype.shareObject=function(e,t,r,n,i,s=!1,o=!1,a=!0){return Ji(this,{emailData:n,group:i,includeAnonymousLinkInEmail:o,loginNames:t,propagateAcl:s,role:r,url:e,useSimplifiedRoles:a})},vt.prototype.shareObjectRaw=function(e){return Ji(this,e,!0)},vt.prototype.unshareObject=function(e){return We(bt(this,"unshareObject"),Fe({url:e}))};class as extends Ke{constructor(e,t=""){super($e("string"==typeof e?e:e.toUrl()),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}execute(e){return We(this,Fe(e,Le({"Content-Type":"application/json;charset=utf-8"})))}createSiteDesign(e){return this.clone(cs,"CreateSiteDesign").execute({info:e})}applySiteDesign(e,t){return this.clone(cs,"ApplySiteDesign").execute({siteDesignId:e,webUrl:t})}getSiteDesigns(){return this.clone(cs,"GetSiteDesigns").execute({})}getSiteDesignMetadata(e){return this.clone(cs,"GetSiteDesignMetadata").execute({id:e})}updateSiteDesign(e){return this.clone(cs,"UpdateSiteDesign").execute({updateInfo:e})}deleteSiteDesign(e){return this.clone(cs,"DeleteSiteDesign").execute({id:e})}getSiteDesignRights(e){return this.clone(cs,"GetSiteDesignRights").execute({id:e})}grantSiteDesignRights(e,t,r=1){return this.clone(cs,"GrantSiteDesignRights").execute({grantedRights:r.toString(),id:e,principalNames:t})}revokeSiteDesignRights(e,t){return this.clone(cs,"RevokeSiteDesignRights").execute({id:e,principalNames:t})}addSiteDesignTask(e,t){return this.clone(cs,"AddSiteDesignTask").execute({webUrl:e,siteDesignId:t})}addSiteDesignTaskToCurrentWeb(e){return this.clone(cs,"AddSiteDesignTaskToCurrentWeb").execute({siteDesignId:e})}getSiteDesignTask(e){return k(this,void 0,void 0,(function*(){const t=yield this.clone(cs,"GetSiteDesignTask").execute({taskId:e});return T(t,"ID")?t:null}))}getSiteDesignRun(e,t){return this.clone(cs,"GetSiteDesignRun").execute({webUrl:e,siteDesignId:t})}getSiteDesignRunStatus(e,t){return this.clone(cs,"GetSiteDesignRunStatus").execute({webUrl:e,runId:t})}}$([ke("sd.createSiteDesign")],as.prototype,"createSiteDesign",null),$([ke("sd.applySiteDesign")],as.prototype,"applySiteDesign",null),$([ke("sd.getSiteDesigns")],as.prototype,"getSiteDesigns",null),$([ke("sd.getSiteDesignMetadata")],as.prototype,"getSiteDesignMetadata",null),$([ke("sd.updateSiteDesign")],as.prototype,"updateSiteDesign",null),$([ke("sd.deleteSiteDesign")],as.prototype,"deleteSiteDesign",null),$([ke("sd.getSiteDesignRights")],as.prototype,"getSiteDesignRights",null),$([ke("sd.grantSiteDesignRights")],as.prototype,"grantSiteDesignRights",null),$([ke("sd.revokeSiteDesignRights")],as.prototype,"revokeSiteDesignRights",null),$([ke("sd.addSiteDesignTask")],as.prototype,"addSiteDesignTask",null),$([ke("sd.addSiteDesignTaskToCurrentWeb")],as.prototype,"addSiteDesignTaskToCurrentWeb",null),$([ke("sd.getSiteDesignTask")],as.prototype,"getSiteDesignTask",null),$([ke("sd.getSiteDesignRun")],as.prototype,"getSiteDesignRun",null),$([ke("sd.getSiteDesignRunStatus")],as.prototype,"getSiteDesignRunStatus",null);const ls=(e,t)=>new as(e,t),cs=(e,t="")=>ls(e,t);vt.prototype.getSiteDesignRuns=function(e){return ls(this,"").getSiteDesignRun(void 0,e)},vt.prototype.addSiteDesignTask=function(e){return ls(this,"").addSiteDesignTaskToCurrentWeb(e)},vt.prototype.getSiteDesignRunStatus=function(e){return ls(this,"").getSiteDesignRunStatus(void 0,e)},Reflect.defineProperty(ht.prototype,"siteDesigns",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>ls(t).configure(e).setRuntime(r)))}}),Y(vt,"siteGroups",Ui),Y(vt,"associatedOwnerGroup",Ui,"associatedownergroup"),Y(vt,"associatedMemberGroup",Ui,"associatedmembergroup"),Y(vt,"associatedVisitorGroup",Ui,"associatedvisitorgroup"),vt.prototype.createDefaultAssociatedGroups=function(e,t,r=!1,n=!0,i){return k(this,void 0,void 0,(function*(){yield this.breakRoleInheritance(r,n);const s=this.clone(bt,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return s.query.set("@u",`'${pt(t||"")}'`),s.query.set("@v",`'${pt(i||"")}'`),s.query.set("@s",`'${pt(e||"")}'`),We(s)}))};class us extends Ke{constructor(e,t=""){super($e("string"==typeof e?e:e.toUrl()),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}execute(e){return We(this,Fe(e))}getSiteScripts(){return this.clone(hs,"GetSiteScripts",!0).execute({})}createSiteScript(e,t,r){return this.clone(hs,`CreateSiteScript(Title=@title,Description=@desc)?@title='${pt(e)}'&@desc='${pt(t)}'`).execute(r)}getSiteScriptMetadata(e){return this.clone(hs,"GetSiteScriptMetadata").execute({id:e})}deleteSiteScript(e){return this.clone(hs,"DeleteSiteScript").execute({id:e})}updateSiteScript(e,t){return t&&(e.Content=JSON.stringify(t)),this.clone(hs,"UpdateSiteScript").execute({updateInfo:e})}getSiteScriptFromList(e){return this.clone(hs,"GetSiteScriptFromList").execute({listUrl:e})}getSiteScriptFromWeb(e,t){return this.clone(hs,"getSiteScriptFromWeb").execute({webUrl:e,info:t})}executeSiteScriptAction(e){return this.clone(hs,"executeSiteScriptAction").execute({actionDefinition:e})}}$([ke("ss.getSiteScripts")],us.prototype,"getSiteScripts",null),$([ke("ss.createSiteScript")],us.prototype,"createSiteScript",null),$([ke("ss.getSiteScriptMetadata")],us.prototype,"getSiteScriptMetadata",null),$([ke("ss.deleteSiteScript")],us.prototype,"deleteSiteScript",null),$([ke("ss.updateSiteScript")],us.prototype,"updateSiteScript",null),$([ke("ss.getSiteScriptFromList")],us.prototype,"getSiteScriptFromList",null),$([ke("ss.getSiteScriptFromWeb")],us.prototype,"getSiteScriptFromWeb",null),$([ke("ss.executeSiteScriptAction")],us.prototype,"executeSiteScriptAction",null);const ds=(e,t)=>new us(e,t),hs=(e,t="")=>ds(e,t);var ps;!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.NoOp=2]="NoOp",e[e.SucceededWithException=3]="SucceededWithException"}(ps||(ps={})),vt.prototype.getSiteScript=function(e){return ds(this.toUrl(),"").getSiteScriptFromWeb(void 0,e)},Tt.prototype.getSiteScript=function(){return k(this,void 0,void 0,(function*(){const e=yield this.clone(wt).rootFolder.get(),t=h((yield bt($e(this.toUrl())).select("Url").get()).Url,"Lists",e.Name);return ds(this,"").getSiteScriptFromList(t)}))},Reflect.defineProperty(ht.prototype,"siteScripts",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>ds(t).configure(e).setRuntime(r)))}}),Y(vt,"siteUsers",Ci),Y(vt,"currentUser",xi,"currentuser"),vt.prototype.ensureUser=function(e){return k(this,void 0,void 0,(function*(){const t=yield We(this.clone(bt,"ensureuser"),Fe({logonName:e}));return{data:t,user:xi(it(t))}}))},vt.prototype.getUserById=function(e){return xi(this,`getUserById(${e})`)};let gs=class extends Ze{get my(){return vs(this)}getFollowedSitesUri(){return k(this,void 0,void 0,(function*(){const e=yield this.clone(fs,"FollowedSitesUri").get();return e.FollowedSitesUri||e}))}getFollowedDocumentsUri(){return k(this,void 0,void 0,(function*(){const e=yield this.clone(fs,"FollowedDocumentsUri").get();return e.FollowedDocumentsUri||e}))}follow(e){return k(this,void 0,void 0,(function*(){return yield We(this.clone(fs,"follow"),this.createSocialActorInfoRequestBody(e))}))}isFollowed(e){return k(this,void 0,void 0,(function*(){return yield We(this.clone(fs,"isfollowed"),this.createSocialActorInfoRequestBody(e))}))}stopFollowing(e){return k(this,void 0,void 0,(function*(){return yield We(this.clone(fs,"stopfollowing"),this.createSocialActorInfoRequestBody(e))}))}createSocialActorInfoRequestBody(e){return Fe({actor:Object.assign(Be("SP.Social.SocialActorInfo"),{Id:null},e)})}};$([ke("soc.getFollowedSitesUri")],gs.prototype,"getFollowedSitesUri",null),$([ke("soc.getFollowedDocumentsUri")],gs.prototype,"getFollowedDocumentsUri",null),$([ke("soc.follow")],gs.prototype,"follow",null),$([ke("soc.isFollowed")],gs.prototype,"isFollowed",null),$([ke("soc.stopFollowing")],gs.prototype,"stopFollowing",null),gs=$([nt("_api/social.following")],gs);const ys=e=>new gs(e),fs=(e,t)=>new gs(e,t);let ms=class extends Ze{followed(e){return k(this,void 0,void 0,(function*(){const t=yield this.clone(bs,`followed(types=${e})`)();return T(t,"Followed")?t.Followed.results:t}))}followedCount(e){return k(this,void 0,void 0,(function*(){const t=yield this.clone(bs,`followedcount(types=${e})`)();return t.FollowedCount||t}))}followers(){return k(this,void 0,void 0,(function*(){const e=yield this.clone(bs,"followers")();return T(e,"Followers")?e.Followers.results:e}))}suggestions(){return k(this,void 0,void 0,(function*(){const e=yield this.clone(bs,"suggestions")();return T(e,"Suggestions")?e.Suggestions.results:e}))}};$([ke("msoc.followed")],ms.prototype,"followed",null),$([ke("msoc.followedCount")],ms.prototype,"followedCount",null),$([ke("msoc.followers")],ms.prototype,"followers",null),$([ke("msoc.suggestions")],ms.prototype,"suggestions",null),ms=$([nt("my")],ms);const vs=Qe(ms),bs=(e,t)=>vs(e,t);var Ss,Ps,Is,Ts;!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(Ss||(Ss={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(Ps||(Ps={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(Is||(Is={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}(Ts||(Ts={})),Reflect.defineProperty(ht.prototype,"social",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>ys(t).configure(e).setRuntime(r)))}});const ws=Qe(class extends Ke{constructor(e,t){super($e("string"==typeof e?e:e.toUrl()),`_api/SP.Utilities.Utility.${t}`)}excute(e){return We(this,Fe(e))}sendEmail(e){const t={properties:v(Be("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&e.To.length>0&&(t.properties=v(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=v(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=v(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=v(t.properties,{AdditionalHeaders:qt(e.AdditionalHeaders)})),ke.configure(this.clone(Cs,"SendEmail",!0),"u.sendEmail").excute(t)}getCurrentUserEmailAddresses(){return ke.configure(this.clone(Cs,"GetCurrentUserEmailAddresses",!0),"u.getCurrentUserEmailAddresses").excute({})}resolvePrincipal(e,t,r,n,i,s=!1){const o={addToUserInfoList:i,input:e,inputIsEmailOnly:n,matchUserInfoList:s,scopes:t,sources:r},a=this.clone(Cs,"ResolvePrincipalInCurrentContext",!0);return ke.configure(a,"u.ResolvePrincipalInCurrentContext").excute(o)}searchPrincipals(e,t,r,n,i){const s={groupName:n,input:e,maxCount:i,scopes:t,sources:r},o=this.clone(Cs,"SearchPrincipalsUsingContextWeb",!0);return ke.configure(o,"u.SearchPrincipalsUsingContextWeb").excute(s)}createEmailBodyForInvitation(e){const t={pageAddress:e},r=this.clone(Cs,"CreateEmailBodyForInvitation",!0);return ke.configure(r,"u.CreateEmailBodyForInvitation").excute(t)}expandGroupsToPrincipals(e,t=30){const r={inputs:e,maxCount:t},n=this.clone(Cs,"ExpandGroupsToPrincipals",!0);return ke.configure(n,"u.ExpandGroupsToPrincipals").excute(r)}createWikiPage(e){return k(this,void 0,void 0,(function*(){const t=this.clone(Cs,"CreateWikiPageInContextWeb",!0),r=yield ke.configure(t,"u.CreateWikiPageInContextWeb").excute({parameters:e});return{data:r,file:Sr(it(r))}}))}}),Cs=(e,t)=>ws(e,t);Reflect.defineProperty(ht.prototype,"utility",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>ws(t,"").configure(e).setRuntime(r)))}});let xs=class extends Je{getById(e){return ke.configure(Ds(this).concat(`('${e}')`),"subs.getById")}add(e,t,r){return k(this,void 0,void 0,(function*(){const n={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};r&&(n.clientState=r);const i=yield We(this,Fe(n,Le({"Content-Type":"application/json"})));return{data:i,subscription:this.getById(i.id)}}))}};$([ke("subs.add")],xs.prototype,"add",null),xs=$([nt("subscriptions")],xs);const Rs=Qe(xs);class Us extends Ze{update(e,t,r){return k(this,void 0,void 0,(function*(){const n={};return e&&(n.expirationDateTime=e),t&&(n.notificationUrl=t),r&&(n.clientState=r),{data:yield Ve(this,Fe(n,Le({"Content-Type":"application/json"}))),subscription:this}}))}delete(){return He(this)}}$([ke("sub.update")],Us.prototype,"update",null),$([ke("sub.delete")],Us.prototype,"delete",null);const Ds=Qe(Us);Y(Tt,"subscriptions",Rs);let Fs=class extends Ze{get groups(){return ke.configure($s(this),"txts.groups")}get sets(){return ke.configure(_s(this),"txts.sets")}};Fs=$([nt("_api/v2.1/termstore")],Fs);const Ls=Qe(Fs);let Bs=class extends Je{getById(e){return ke.configure(ks(this,e),"txtgs.getById")}};Bs=$([nt("groups")],Bs);const $s=Qe(Bs),ks=Qe(class extends Ze{get sets(){return ke.configure(_s(this,"sets"),"txtg.sets")}});let As=class extends Je{getById(e){return ke.configure(Os(this,e),"txts.getById")}};As=$([nt("sets")],As);const _s=Qe(As),Os=Qe(class extends Ze{get terms(){return qs(this)}get parentGroup(){return ke.configure(ks(this,"parentGroup"),"txts.parentGroup")}get children(){return ke.configure(Ns(this),"txts.children")}get relations(){return ke.configure(Hs(this),"txts.relations")}getTermById(e){return ke.configure(this.clone(js,`terms/${e}`),"txts.getTermById")}getAllChildrenAsOrderedTree(){return k(this,void 0,void 0,(function*(){const e=yield this.select("*","customSortOrder")(),t=[],r=(t,r,n)=>{let i=null;if(null===r&&n.length>0)i=[...n];else{const t=r.findIndex((t=>t.setId===e.id));t>=0&&(i=[...r[t].order])}if(null!==i){const e=[];return i.forEach((r=>{const n=t.find((e=>r===e.id));n&&e.push(n)})),e}return t},n=(e,t)=>k(this,void 0,void 0,(function*(){const i=yield e.children.select("*","customSortOrder")();for(let e=0;e<i.length;e++){const s=i[e],o=Object.assign({children:[],defaultLabel:s.labels.find((e=>e.isDefault)).name},s);s.childrenCount>0&&(yield n(this.getTermById(i[e].id),o.children),o.children=r(o.children,s.customSortOrder)),t.push(o)}}));return yield n(this,t),r(t,null,e.customSortOrder)}))}});let Es=class extends Je{};Es=$([nt("children")],Es);const Ns=Qe(Es);let Ms=class extends Je{getById(e){return js(this,e)}};Ms=$([nt("terms")],Ms);const qs=Qe(Ms),js=Qe(class extends Ze{get children(){return ke.configure(Ns(this),"txt.children")}get relations(){return ke.configure(Hs(this),"txt.relations")}get set(){return ke.configure(Os(this,"set"),"txt.set")}});let Ws=class extends Je{getById(e){return ke.configure(Vs(this,e),"txrs.getById")}};Ws=$([nt("relations")],Ws);const Hs=Qe(Ws),Vs=Qe(class extends Ze{get fromTerm(){return ke.configure(js(this,"fromTerm"),"txr.fromTerm")}get toTerm(){return ke.configure(js(this,"toTerm"),"txr.toTerm")}get set(){return ke.configure(Os(this,"set"),"txr.set")}});Reflect.defineProperty(ht.prototype,"termStore",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Ls(t).configure(e).setRuntime(r)))}}),Y(Tt,"userCustomActions",ni),Y(vt,"userCustomActions",ni),Y(gt,"userCustomActions",ni);let Gs=class extends Je{add(e,t=!1,r={}){return k(this,void 0,void 0,(function*(){const n=Fe(Object.assign(Be("SP.View"),{PersonalView:t,Title:e},r)),i=yield We(this.clone(zs,null),n);return{data:i,view:this.getById(i.Id)}}))}getById(e){return Ks(this).concat(`('${e}')`)}getByTitle(e){return Ks(this,`getByTitle('${e}')`)}};$([ke("vs.add")],Gs.prototype,"add",null),Gs=$([nt("views")],Gs);const zs=Qe(Gs);class Qs extends Ze{constructor(){super(...arguments),this.delete=tt("vw"),this.update=this._update("SP.View",(e=>({data:e,view:this})))}get fields(){return Js(this)}renderAsHtml(){return this.clone(Ks,"renderashtml")()}setViewXml(e){return We(this.clone(Ks,"SetViewXml"),Fe({viewXml:e}))}}$([ke("v.renderAsHtml")],Qs.prototype,"renderAsHtml",null),$([ke("v.setViewXml")],Qs.prototype,"setViewXml",null);const Ks=Qe(Qs);let Xs=class extends Je{getSchemaXml(){return this.clone(Js,"schemaxml")()}add(e){return We(this.clone(Js,`addviewfield('${e}')`))}move(e,t){return We(this.clone(Js,"moveviewfieldto"),Fe({field:e,index:t}))}removeAll(){return We(this.clone(Js,"removeallviewfields"))}remove(e){return We(this.clone(Js,`removeviewfield('${e}')`))}};$([ke("vfs.getSchemaXml")],Xs.prototype,"getSchemaXml",null),$([ke("vfs.add")],Xs.prototype,"add",null),$([ke("vfs.move")],Xs.prototype,"move",null),$([ke("vfs.removeAll")],Xs.prototype,"removeAll",null),$([ke("vfs.remove")],Xs.prototype,"remove",null),Xs=$([nt("viewfields")],Xs);const Js=Qe(Xs);var Ys;!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.Recursive=1]="Recursive",e[e.RecursiveAll=2]="RecursiveAll",e[e.FilesOnly=3]="FilesOnly"}(Ys||(Ys={})),Y(Tt,"views",zs),Y(Tt,"defaultView",Ks,"DefaultView"),Tt.prototype.getView=function(e){return Ks(this,`getView('${e}')`)};class Zs extends Ke{get scope(){return ke.configure(Xe(this,"Scope"),"f.scope")}get webparts(){return ro(this,"webparts")}export(e){return We(this.clone(to,"ExportWebPart"),Fe({webPartId:e}))}import(e){return We(this.clone(to,"ImportWebPart"),Fe({webPartXml:e}))}}const eo=(e,t)=>new Zs(e,t),to=(e,t)=>eo(e,t),ro=Qe(class extends Je{getById(e){return no(this,`getbyid('${e}')`)}getByControlId(e){return no(this,`getByControlId('${e}')`)}}),no=Qe(class extends Ze{get webpart(){return et(this,"webpart")}saveChanges(){return We(this.clone(no,"SaveWebPartChanges"))}moveTo(e,t){return We(this.clone(no,`MoveWebPartTo(zoneID='${e}', zoneIndex=${t})`))}close(){return We(this.clone(no,"CloseWebPart"))}open(){return We(this.clone(no,"OpenWebPart"))}delete(){return We(this.clone(no,"DeleteWebPart"))}});var io;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(io||(io={})),br.prototype.getLimitedWebPartManager=function(e=io.Shared){return eo(this,`getLimitedWebPartManager(scope=${e})`)};const so=new ht;function oo(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}function ao(){return function(e){return class extends e{delete(){return or(this)}}}}function lo(){return function(e){return class extends e{delete(e="*"){return or(this,Le({"If-Match":e}))}}}}function co(){return function(e){return class extends e{update(e){return ar(this,Fe(e))}}}}function uo(){return function(e){return class extends e{update(e,t="*"){return ar(this,Fe(e,Le({"If-Match":t})))}}}}function ho(){return function(e){return class extends e{add(e){return sr(this,Fe(e))}}}}function po(e){return function(t){return class extends t{getById(t){return e(this,t)}}}}let go=class extends yr{get threads(){return Po(this)}};go=$([co(),ao()],go);const yo=cr(go);let fo=class extends hr{};fo=$([oo("conversations"),ho(),po(yo)],fo);const mo=cr(fo);let vo=class extends yr{get posts(){return Co(this)}reply(e){return sr(this.clone(bo,"reply"),Fe(e))}};vo=$([ao()],vo);const bo=cr(vo);let So=class extends hr{};So=$([oo("threads"),ho(),po(bo)],So);const Po=cr(So);let Io=class extends yr{forward(e){return sr(this.clone(To,"forward"),Fe(e))}reply(e){return sr(this.clone(To,"reply"),Fe(e))}};Io=$([ao()],Io);const To=cr(Io);let wo=class extends hr{};wo=$([oo("posts"),ho(),po(To)],wo);const Co=cr(wo),xo=cr(class extends hr{add(e){return sr(this.clone(xo,"$ref"),Fe({"@odata.id":e}))}remove(e){const t=this.clone(xo,"$ref");return t.query.set("$id",e),or(t)}}),Ro=cr(class extends yr{});let Uo=class extends hr{addFile(e,t){return sr(this,Fe(("#microsoft.graph.fileAttachment",r={contentBytes:t,name:e},Object.assign({"@odata.type":"#microsoft.graph.fileAttachment"},r))));var r}};Uo=$([oo("attachments"),po(Ro)],Uo);const Do=cr(Uo);Y(Io,"attachments",Do);let Fo=class extends yr{getMemberObjects(e=!1){return sr(this.clone(Lo,"getMemberObjects"),Fe({securityEnabledOnly:e}))}getMemberGroups(e=!1){return sr(this.clone(Lo,"getMemberGroups"),Fe({securityEnabledOnly:e}))}checkMemberGroups(e){return sr(this.clone(Lo,"checkMemberGroups"),Fe({groupIds:e}))}};Fo=$([ao()],Fo);const Lo=cr(Fo);let Bo=class extends hr{getByIds(e,t=ko.directoryObject){return sr(this.clone($o,"getByIds"),Fe({ids:e,type:t}))}};Bo=$([oo("directoryObjects"),po(Lo)],Bo);const $o=cr(Bo);var ko,Ao;!function(e){e[e.directoryObject=0]="directoryObject",e[e.user=1]="user",e[e.group=2]="group",e[e.device=3]="device"}(ko||(ko={})),function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(Ao||(Ao={}));let _o=class extends Fo{addFavorite(){return sr(this.clone(Oo,"addFavorite"))}removeFavorite(){return sr(this.clone(Oo,"removeFavorite"))}resetUnseenCount(){return sr(this.clone(Oo,"resetUnseenCount"))}subscribeByMail(){return sr(this.clone(Oo,"subscribeByMail"))}unsubscribeByMail(){return sr(this.clone(Oo,"unsubscribeByMail"))}getCalendarView(e,t){const r=this.clone(Oo,"calendarView");return r.query.set("startDateTime",e.toISOString()),r.query.set("endDateTime",t.toISOString()),r()}};_o=$([ao(),co()],_o);const Oo=cr(_o);let Eo=class extends hr{add(e,t,r,n={}){return k(this,void 0,void 0,(function*(){let i=v({displayName:e,mailEnabled:r===Ao.Office365,mailNickname:t,securityEnabled:r!==Ao.Office365},n);r!==Ao.Security&&(i=v(i,{groupTypes:r===Ao.Office365?["Unified"]:["DynamicMembership"]}));const s=yield sr(this,Fe(i));return{data:s,group:this.getById(s.id)}}))}};Eo=$([oo("groups"),po(Oo)],Eo);const No=cr(Eo);function Mo(e,t){const r=this.clone(pr,"calendarView");return r.query.set("startDateTime",encodeURIComponent(e)),r.query.set("endDateTime",encodeURIComponent(t)),r}const qo=cr(class extends yr{constructor(){super(...arguments),this.calendarView=Mo}get events(){return zo(this)}});let jo=class extends hr{};jo=$([oo("calendars"),po(qo)],jo);const Wo=cr(jo);let Ho=class extends yr{};Ho=$([ao(),co()],Ho);const Vo=cr(Ho);let Go=class extends hr{add(e){return k(this,void 0,void 0,(function*(){const t=yield sr(this,Fe(e));return{data:t,event:this.getById(t.id)}}))}};Go=$([oo("events"),po(Vo)],Go);const zo=cr(Go);Y(_o,"calendar",qo,"calendar"),Y(_o,"events",zo);let Qo=class extends Fo{get memberOf(){return $o(this,"memberOf")}get people(){return Zo(this)}};Qo=$([co(),ao()],Qo);const Ko=cr(Qo);let Xo=class extends hr{};Xo=$([oo("users"),po(Ko)],Xo);const Jo=cr(Xo);let Yo=class extends hr{};Yo=$([oo("people")],Yo);const Zo=cr(Yo);Y(Qo,"calendar",qo,"calendar"),Y(Qo,"calendars",Wo,"calendars"),Y(Qo,"events",zo),Qo.prototype.calendarView=Mo;let ea=class extends yr{};ea=$([co(),ao()],ea);const ta=cr(ea);let ra=class extends hr{add(e,t,r,n,i={}){return k(this,void 0,void 0,(function*(){const s=v({businessPhones:n,emailAddresses:r,givenName:e,surName:t},i),o=yield sr(this,Fe(s));return{contact:this.getById(o.id),data:o}}))}};ra=$([oo("contacts"),po(ta)],ra);const na=cr(ra);let ia=class extends yr{get contacts(){return na(this)}get childFolders(){return aa(this,"childFolders")}};ia=$([ao(),co()],ia);const sa=cr(ia);let oa=class extends hr{add(e,t){return k(this,void 0,void 0,(function*(){const r={displayName:e,parentFolderId:t},n=yield sr(this,Fe(r));return{contactFolder:this.getById(n.id),data:n}}))}};oa=$([oo("contactFolders"),po(sa)],oa);const aa=cr(oa);Y(Qo,"contacts",na),Y(Qo,"contactFolders",aa),Y(_o,"conversations",mo),Y(_o,"acceptedSenders",xo,"acceptedsenders"),Y(_o,"rejectedSenders",xo,"rejectedsenders"),Reflect.defineProperty(Jt.prototype,"directoryObjects",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>$o(t).configure(e).setRuntime(r)))}}),Reflect.defineProperty(Jt.prototype,"groups",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>No(t).configure(e).setRuntime(r)))}});let la=class extends yr{get trending(){return ha(this)}get used(){return ya(this)}get shared(){return va(this)}};la=$([oo("insights")],la);const ca=cr(la),ua=cr(class extends yr{get resource(){return Sa(this)}});let da=class extends hr{};da=$([oo("trending"),po(ua)],da);const ha=cr(da),pa=cr(class extends yr{get resource(){return Sa(this)}});let ga=class extends hr{};ga=$([oo("used"),po(pa)],ga);const ya=cr(ga),fa=cr(class extends yr{get resource(){return Sa(this)}});let ma=class extends hr{};ma=$([oo("shared"),po(fa)],ma);const va=cr(ma);let ba=class extends yr{};ba=$([oo("resource")],ba);const Sa=cr(ba);Y(Qo,"insights",ca);let Pa=class extends hr{create(e,t,r={}){return k(this,void 0,void 0,(function*(){const n=v({inviteRedirectUrl:t,invitedUserEmailAddress:e},r);return{data:yield sr(this,Fe(n))}}))}};Pa=$([oo("invitations")],Pa);const Ia=cr(Pa);Reflect.defineProperty(Jt.prototype,"invitations",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Ia(t).configure(e).setRuntime(r)))}});const Ta=cr(class extends yr{remove(){return or(this.clone(Ta,"$ref"))}});let wa=class extends hr{add(e){return sr(this.clone(Ca,"$ref"),Fe({"@odata.id":e}))}};wa=$([oo("members"),po(Ta)],wa);const Ca=cr(wa);Y(_o,"owners",Ca,"owners"),Y(_o,"members",Ca);const xa=cr(class extends yr{});let Ra=class extends hr{};Ra=$([oo("messages"),po(xa),ho()],Ra);const Ua=cr(Ra),Da=cr(class extends yr{});let Fa=class extends hr{};Fa=$([oo("mailFolders"),po(Da),ho()],Fa);const La=cr(Fa);let Ba=class extends yr{};Ba=$([oo("mailboxSettings"),co()],Ba);const $a=cr(Ba);Y(Qo,"messages",Ua),Y(Qo,"mailboxSettings",$a),Y(Qo,"mailFolders",La),Qo.prototype.sendMail=function(e){return sr(this.clone(Ko,"sendMail"),Fe(e))};let ka=class extends yr{get root(){return Na(this)}get list(){return this.clone(fr,"list")}get recent(){return Wa(this,"recent")}get sharedWithMe(){return Wa(this,"sharedWithMe")}getItemById(e){return qa(this,h("items",e))}};ka=$([oo("drive")],ka);const Aa=cr(ka);let _a=class extends hr{};_a=$([oo("drives"),po(Aa)],_a);const Oa=cr(_a);let Ea=class extends yr{get children(){return Wa(this,"children")}search(e){const t=this.clone(Na);return t.query.set("search",`'${e}'`),t()}get thumbnails(){return this.clone(pr,"thumbnails")}};Ea=$([oo("root")],Ea);const Na=cr(Ea);let Ma=class extends yr{get children(){return Wa(this,"children")}get thumbnails(){return this.clone(pr,"thumbnails")}get versions(){return this.clone(pr,"versions")}move(e,t){return ar(this,Fe(v(e,{name:t})))}getContent(){return k(this,void 0,void 0,(function*(){const e=yield this.get(),t=yield A.fetch(e["@microsoft.graph.downloadUrl"],{headers:{accept:"application/json"},method:"GET",responseType:"arraybuffer"});return(new ye).parse(t)}))}setContent(e){return lr(this.clone(qa,"content"),{body:e})}};Ma=$([ao(),co()],Ma);const qa=cr(Ma);let ja=class extends hr{};ja=$([po(qa)],ja);const Wa=cr(ja);Y(Qo,"drive",Aa),Y(Qo,"drives",Oa);let Ha=class extends yr{get notebooks(){return Qa(this)}get sections(){return Ja(this)}get pages(){return this.clone(pr,"pages")}};Ha=$([oo("onenote")],Ha);const Va=cr(Ha),Ga=cr(class extends yr{get sections(){return Ja(this)}});let za=class extends hr{add(e){return k(this,void 0,void 0,(function*(){const t=yield sr(this,Fe({displayName:e}));return{data:t,notebook:this.getById(t.id)}}))}};za=$([oo("notebooks"),po(Ga)],za);const Qa=cr(za),Ka=cr(class extends yr{});let Xa=class extends hr{add(e){return k(this,void 0,void 0,(function*(){const t=yield sr(this,Fe({displayName:e}));return{data:t,section:this.getById(t.id)}}))}};Xa=$([oo("sections"),po(Ka)],Xa);const Ja=cr(Xa);Y(Qo,"onenote",Va);let Ya=class extends yr{getBlob(){return this.clone(Za,"$value",!1).usingParser(new ye)()}getBuffer(){return this.clone(Za,"$value",!1).usingParser(new me)()}setContent(e){return ar(this.clone(Za,"$value",!1),{body:e})}};Ya=$([oo("photo")],Ya);const Za=cr(Ya);Y(_o,"photo",Za),Y(Qo,"photo",Za);let el=class extends yr{get plans(){return al(this)}get tasks(){return pl(this)}get buckets(){return ml(this)}};el=$([oo("planner")],el);const tl=cr(el);let rl=class extends yr{};rl=$([oo("details"),uo()],rl);const nl=cr(rl);let il=class extends yr{get tasks(){return pl(this)}get buckets(){return ml(this)}get details(){return nl(this)}};il=$([uo(),lo()],il);const sl=cr(il);let ol=class extends hr{add(e,t){return k(this,void 0,void 0,(function*(){const r=yield sr(this,Fe({owner:e,title:t}));return{data:r,plan:this.getById(r.id)}}))}};ol=$([oo("plans"),po(sl)],ol);const al=cr(ol);let ll=class extends yr{};ll=$([oo("details"),uo()],ll);const cl=cr(ll);let ul=class extends yr{get details(){return cl(this)}};ul=$([uo(),lo()],ul);const dl=cr(ul);let hl=class extends hr{add(e,t,r,n){return k(this,void 0,void 0,(function*(){let i=v({planId:e,title:t},r);n&&(i=v(i,{bucketId:n}));const s=yield sr(this,Fe(i));return{data:s,task:this.getById(s.id)}}))}};hl=$([oo("tasks"),po(dl)],hl);const pl=cr(hl);let gl=class extends yr{get tasks(){return pl(this)}};gl=$([uo(),lo()],gl);const yl=cr(gl);let fl=class extends hr{add(e,t,r){return k(this,void 0,void 0,(function*(){const n={name:e,orderHint:r||"",planId:t},i=yield sr(this,Fe(n));return{bucket:this.getById(i.id),data:i}}))}};fl=$([oo("buckets"),po(yl)],fl);const ml=cr(fl);Y(_o,"plans",al,"planner/plans"),Y(Qo,"tasks",pl,"planner/tasks"),Reflect.defineProperty(Jt.prototype,"planner",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>tl(t).configure(e).setRuntime(r)))}});let vl=class extends yr{executeQuery(e){return sr(bl(this,"query"),Fe(e))}};vl=$([oo("search")],vl);const bl=cr(vl);Jt.prototype.query=function(...e){return k(this,void 0,void 0,(function*(){return this.childConfigHook((({options:t,baseUrl:r,runtime:n})=>bl(r).configure(t).setRuntime(n).executeQuery({requests:e})))}))};let Sl=class extends yr{};Sl=$([ao(),co()],Sl);const Pl=cr(Sl);let Il=class extends hr{add(e,t,r,n,i={}){return k(this,void 0,void 0,(function*(){const s=v({changeType:e,expirationDateTime:n,notificationUrl:t,resource:r},i),o=yield sr(this,Fe(s));return{data:o,subscription:this.getById(o.id)}}))}};Il=$([oo("subscriptions"),po(Pl)],Il);const Tl=cr(Il);Reflect.defineProperty(Jt.prototype,"subscriptions",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Tl(t).configure(e).setRuntime(r)))}});let wl=class extends yr{get channels(){return Fl(this)}archive(e=!1){return sr(this.clone(Cl,"archive"),Fe({shouldSetSpoSiteReadOnlyForMembers:e}))}unarchive(){return sr(this.clone(Cl,"unarchive"))}cloneTeam(e,t="",r="apps,tabs,settings,channels,members",n="private"){return k(this,void 0,void 0,(function*(){const i={description:t||"",displayName:e,mailNickname:e,partsToClone:r,visibility:n},s=new ve((e=>Promise.resolve(e.headers))),o=Rl(this,"clone").usingParser(s),a=yield sr(o,Fe(i)),l={teamId:"",operationId:""};if(a.has("location")){const e=a.get("location").split("/");3===e.length&&(l.teamId=e[1].substring(e[1].indexOf("'")+1,e[1].lastIndexOf("'")),l.operationId=e[2].substring(e[2].indexOf("'")+1,e[2].lastIndexOf("'")))}return l}))}getOperationById(e){return fr(this,`operations/${e}`)()}};wl=$([oo("team"),co()],wl);const Cl=cr(wl);let xl=class extends hr{create(e){return k(this,void 0,void 0,(function*(){const t=new ve((e=>Promise.resolve(e.headers))),r=Rl(this,null).usingParser(t),n=yield sr(r,Fe(e)),i={teamId:"",operationId:""};if(n.has("location")){const e=n.get("location").split("/");3===e.length&&(i.teamId=e[1].substring(e[1].indexOf("'")+1,e[1].lastIndexOf("'")),i.operationId=e[2].substring(e[2].indexOf("'")+1,e[2].lastIndexOf("'")))}return i}))}};xl=$([oo("teams"),po(Cl)],xl);const Rl=cr(xl),Ul=cr(class extends yr{get tabs(){return kl(this)}});let Dl=class extends hr{add(e,t=""){return k(this,void 0,void 0,(function*(){const r={description:t,displayName:e},n=yield sr(this,Fe(r));return{channel:this.getById(n.id),data:n}}))}};Dl=$([oo("channels"),po(Ul)],Dl);const Fl=cr(Dl);let Ll=class extends yr{};Ll=$([oo("tab"),co(),ao()],Ll);const Bl=cr(Ll);let $l=class extends hr{add(e,t,r){return k(this,void 0,void 0,(function*(){const n=v({displayName:e,"teamsApp@odata.bind":t},r),i=yield sr(this,Fe(n));return{data:i,tab:this.getById(i.id)}}))}};$l=$([oo("tabs"),po(Bl)],$l);const kl=cr($l);Y(Qo,"joinedTeams",Rl,"joinedTeams"),Y(_o,"team",Cl),_o.prototype.createTeam=function(e){return k(this,void 0,void 0,(function*(){return{data:yield lr(this.clone(Oo,"team"),Fe(e)),team:this.team}}))},Reflect.defineProperty(Jt.prototype,"teams",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Rl(t).configure(e).setRuntime(r)))}}),Reflect.defineProperty(Jt.prototype,"me",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Ko(t,"me").configure(e).setRuntime(r)))}}),Reflect.defineProperty(Jt.prototype,"users",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Jo(t).configure(e).setRuntime(r)))}});const Al={assign:v,combine:h,dateAdd:d,getCtxCallback:u,getGUID:g,getRandomString:p,isArray:m,isFunc:y,isUrlAbsolute:b,objectDefinedNotNull:f,sanitizeGuid:P,stringIsNullOrEmpty:S},_l=Gt,Ol=Yt,El=new V,Nl=new G,Ml=o,ql=function(e){B.assign(e)},jl={config:Nl,graph:Ol,log:o,setup:ql,sp:_l,storage:El,util:Al}}},t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(584)})()}));
//# sourceMappingURL=pnp.js.map